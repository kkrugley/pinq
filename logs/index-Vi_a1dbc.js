var In=Object.defineProperty;var Ln=(r,e,t)=>e in r?In(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var ve=(r,e,t)=>Ln(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function ge(){}function rn(r){return r()}function Er(){return Object.create(null)}function tt(r){r.forEach(rn)}function nn(r){return typeof r=="function"}function rt(r,e){return r!=r?e==e:r!==e||r&&typeof r=="object"||typeof r=="function"}function Pn(r){return Object.keys(r).length===0}function I(r,e){r.appendChild(e)}function we(r,e,t){r.insertBefore(e,t||null)}function ye(r){r.parentNode&&r.parentNode.removeChild(r)}function W(r){return document.createElement(r)}function fe(r){return document.createTextNode(r)}function ee(){return fe(" ")}function Le(r,e,t,n){return r.addEventListener(e,t,n),()=>r.removeEventListener(e,t,n)}function U(r,e,t){t==null?r.removeAttribute(e):r.getAttribute(e)!==t&&r.setAttribute(e,t)}function Dn(r){return Array.from(r.childNodes)}function Se(r,e){e=""+e,r.data!==e&&(r.data=e)}function Rr(r,e){r.value=e??""}function Mn(r,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(r,{detail:e,bubbles:t,cancelable:n})}let ht;function ft(r){ht=r}function sn(){if(!ht)throw new Error("Function called outside component initialization");return ht}function Un(r){sn().$$.on_destroy.push(r)}function on(){const r=sn();return(e,t,{cancelable:n=!1}={})=>{const o=r.$$.callbacks[e];if(o){const a=Mn(e,t,{cancelable:n});return o.slice().forEach(c=>{c.call(r,a)}),!a.defaultPrevented}return!0}}const Xe=[],Zt=[];let Qe=[];const $t=[],qn=Promise.resolve();let er=!1;function jn(){er||(er=!0,qn.then(an))}function tr(r){Qe.push(r)}function Wn(r){$t.push(r)}const Ot=new Set;let Je=0;function an(){if(Je!==0)return;const r=ht;do{try{for(;Je<Xe.length;){const e=Xe[Je];Je++,ft(e),Hn(e.$$)}}catch(e){throw Xe.length=0,Je=0,e}for(ft(null),Xe.length=0,Je=0;Zt.length;)Zt.pop()();for(let e=0;e<Qe.length;e+=1){const t=Qe[e];Ot.has(t)||(Ot.add(t),t())}Qe.length=0}while(Xe.length);for(;$t.length;)$t.pop()();er=!1,Ot.clear(),ft(r)}function Hn(r){if(r.fragment!==null){r.update(),tt(r.before_update);const e=r.dirty;r.dirty=[-1],r.fragment&&r.fragment.p(r.ctx,e),r.after_update.forEach(tr)}}function Vn(r){const e=[],t=[];Qe.forEach(n=>r.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),Qe=e}const mt=new Set;let We;function Ft(){We={r:0,c:[],p:We}}function It(){We.r||tt(We.c),We=We.p}function de(r,e){r&&r.i&&(mt.delete(r),r.i(e))}function xe(r,e,t,n){if(r&&r.o){if(mt.has(r))return;mt.add(r),We.c.push(()=>{mt.delete(r),n&&(t&&r.d(1),n())}),r.o(e)}else n&&n()}function Yn(r,e,t){const n=r.$$.props[e];n!==void 0&&(r.$$.bound[n]=t,t(r.$$.ctx[n]))}function dt(r){r&&r.c()}function Ze(r,e,t){const{fragment:n,after_update:o}=r.$$;n&&n.m(e,t),tr(()=>{const a=r.$$.on_mount.map(rn).filter(nn);r.$$.on_destroy?r.$$.on_destroy.push(...a):tt(a),r.$$.on_mount=[]}),o.forEach(tr)}function $e(r,e){const t=r.$$;t.fragment!==null&&(Vn(t.after_update),tt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Kn(r,e){r.$$.dirty[0]===-1&&(Xe.push(r),jn(),r.$$.dirty.fill(0)),r.$$.dirty[e/31|0]|=1<<e%31}function nt(r,e,t,n,o,a,c=null,l=[-1]){const p=ht;ft(r);const g=r.$$={fragment:null,ctx:[],props:a,update:ge,not_equal:o,bound:Er(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(p?p.$$.context:[])),callbacks:Er(),dirty:l,skip_bound:!1,root:e.target||p.$$.root};c&&c(g.root);let y=!1;if(g.ctx=t?t(r,e.props||{},(w,v,...C)=>{const A=C.length?C[0]:v;return g.ctx&&o(g.ctx[w],g.ctx[w]=A)&&(!g.skip_bound&&g.bound[w]&&g.bound[w](A),y&&Kn(r,w)),v}):[],g.update(),y=!0,tt(g.before_update),g.fragment=n?n(g.ctx):!1,e.target){if(e.hydrate){const w=Dn(e.target);g.fragment&&g.fragment.l(w),w.forEach(ye)}else g.fragment&&g.fragment.c();e.intro&&de(r.$$.fragment),Ze(r,e.target,e.anchor),an()}ft(p)}class it{constructor(){ve(this,"$$");ve(this,"$$set")}$destroy(){$e(this,1),this.$destroy=ge}$on(e,t){if(!nn(t))return ge;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const o=n.indexOf(t);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!Pn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Gn="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Gn);function Jn(r){let e,t,n;return{c(){e=W("p"),t=fe(r[0]),U(e,"class",n=`text-sm ${r[2][r[1]]}`)},m(o,a){we(o,e,a),I(e,t)},p(o,[a]){a&1&&Se(t,o[0]),a&2&&n!==(n=`text-sm ${o[2][o[1]]}`)&&U(e,"class",n)},i:ge,o:ge,d(o){o&&ye(e)}}}function zn(r,e,t){let{status:n}=e,{tone:o="idle"}=e;const a={idle:"text-slate-200",success:"text-success",error:"text-error"};return r.$$set=c=>{"status"in c&&t(0,n=c.status),"tone"in c&&t(1,o=c.tone)},[n,o,a]}class Xn extends it{constructor(e){super(),nt(this,e,zn,Jn,rt,{status:0,tone:1})}}function Qn(r){let e,t,n,o,a,c,l,p,g,y;return{c(){e=W("div"),t=W("div"),n=W("p"),n.textContent="Pairing code",o=ee(),a=W("p"),c=fe(r[0]),l=ee(),p=W("button"),p.textContent="Copy",U(n,"class","text-xs uppercase tracking-wide text-slate-400"),U(a,"class","text-3xl font-semibold text-white"),U(p,"type","button"),U(p,"class","bg-primary text-white px-4 py-2 rounded-lg shadow hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-primary"),U(e,"class","bg-slate-800 border border-slate-700 rounded-xl p-4 shadow-md flex items-center justify-between gap-3")},m(w,v){we(w,e,v),I(e,t),I(t,n),I(t,o),I(t,a),I(a,c),I(e,l),I(e,p),g||(y=Le(p,"click",r[1]),g=!0)},p(w,[v]){v&1&&Se(c,w[0])},i:ge,o:ge,d(w){w&&ye(e),g=!1,y()}}}function Zn(r,e,t){let{code:n}=e;const o=on();async function a(){navigator.clipboard&&(await navigator.clipboard.writeText(n),o("copied"))}return r.$$set=c=>{"code"in c&&t(0,n=c.code)},[n,a]}class $n extends it{constructor(e){super(),nt(this,e,Zn,Qn,rt,{code:0})}}function ei(r){let e,t,n,o,a,c;return{c(){e=W("label"),t=W("div"),t.innerHTML='<svg class="w-10 h-10 mb-3 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M7 10l5-5m0 0l5 5m-5-5v12"></path></svg> <p class="text-sm text-slate-300">Drop a file here or click to browse</p> <p class="text-xs text-slate-500">Max 50 MB</p>',n=ee(),o=W("input"),U(t,"class","flex flex-col items-center justify-center pt-4 pb-4"),U(o,"id","dropzone-file"),U(o,"type","file"),U(o,"class","hidden"),U(e,"class","flex flex-col items-center justify-center w-full h-36 border-2 border-dashed border-slate-600 rounded-xl cursor-pointer bg-slate-800/40 hover:border-primary transition-colors")},m(l,p){we(l,e,p),I(e,t),I(e,n),I(e,o),a||(c=Le(o,"change",r[0]),a=!0)},p:ge,i:ge,o:ge,d(l){l&&ye(e),a=!1,c()}}}function ti(r){const e=on();function t(n){const o=n.target,[a]=o.files??[];e("select",a??null)}return[t]}class ri extends it{constructor(e){super(),nt(this,e,ti,ei,rt,{})}}function ni(r){let e,t,n,o=(r[1]??"Progress")+"",a,c,l,p=Math.round(r[0])+"",g,y,w,v,C,A;return{c(){e=W("div"),t=W("div"),n=W("span"),a=fe(o),c=ee(),l=W("span"),g=fe(p),y=fe("%"),w=ee(),v=W("div"),C=W("div"),U(t,"class","flex justify-between mb-1 text-sm text-slate-300"),U(C,"class","bg-primary h-3 rounded-full transition-all"),U(C,"style",A=`width: ${Math.min(100,Math.max(0,r[0]))}%`),U(v,"class","w-full bg-slate-800 rounded-full h-3"),U(e,"class","w-full")},m(x,B){we(x,e,B),I(e,t),I(t,n),I(n,a),I(t,c),I(t,l),I(l,g),I(l,y),I(e,w),I(e,v),I(v,C)},p(x,[B]){B&2&&o!==(o=(x[1]??"Progress")+"")&&Se(a,o),B&1&&p!==(p=Math.round(x[0])+"")&&Se(g,p),B&1&&A!==(A=`width: ${Math.min(100,Math.max(0,x[0]))}%`)&&U(C,"style",A)},i:ge,o:ge,d(x){x&&ye(e)}}}function ii(r,e,t){let{value:n=0}=e,{label:o=null}=e;return r.$$set=a=>{"value"in a&&t(0,n=a.value),"label"in a&&t(1,o=a.label)},[n,o]}class si extends it{constructor(e){super(),nt(this,e,ii,ni,rt,{value:0,label:1})}}function oi(r){let e,t,n;return{c(){e=W("textarea"),U(e,"class","w-full rounded-xl bg-slate-800 border border-slate-700 text-slate-100 p-3 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"),U(e,"rows","6"),U(e,"placeholder",r[1]),e.disabled=r[2]},m(o,a){we(o,e,a),Rr(e,r[0]),t||(n=Le(e,"input",r[3]),t=!0)},p(o,[a]){a&2&&U(e,"placeholder",o[1]),a&4&&(e.disabled=o[2]),a&1&&Rr(e,o[0])},i:ge,o:ge,d(o){o&&ye(e),t=!1,n()}}}function ai(r,e,t){let{value:n=""}=e,{placeholder:o="Enter text to send"}=e,{disabled:a=!1}=e;function c(){n=this.value,t(0,n)}return r.$$set=l=>{"value"in l&&t(0,n=l.value),"placeholder"in l&&t(1,o=l.placeholder),"disabled"in l&&t(2,a=l.disabled)},[n,o,a,c]}class ui extends it{constructor(e){super(),nt(this,e,ai,oi,rt,{value:0,placeholder:1,disabled:2})}}const li="https://pinq.onrender.com",vr="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function Cr(){let r="";for(let e=0;e<6;e+=1)r+=vr[Math.floor(Math.random()*vr.length)];return r}var Pe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ci(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function fi(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var o=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:function(){return r[n]}})}),t}var rr={exports:{}},Lt,Tr;function hi(){if(Tr)return Lt;Tr=1;var r=1e3,e=r*60,t=e*60,n=t*24,o=n*7,a=n*365.25;Lt=function(y,w){w=w||{};var v=typeof y;if(v==="string"&&y.length>0)return c(y);if(v==="number"&&isFinite(y))return w.long?p(y):l(y);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(y))};function c(y){if(y=String(y),!(y.length>100)){var w=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(y);if(w){var v=parseFloat(w[1]),C=(w[2]||"ms").toLowerCase();switch(C){case"years":case"year":case"yrs":case"yr":case"y":return v*a;case"weeks":case"week":case"w":return v*o;case"days":case"day":case"d":return v*n;case"hours":case"hour":case"hrs":case"hr":case"h":return v*t;case"minutes":case"minute":case"mins":case"min":case"m":return v*e;case"seconds":case"second":case"secs":case"sec":case"s":return v*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}}function l(y){var w=Math.abs(y);return w>=n?Math.round(y/n)+"d":w>=t?Math.round(y/t)+"h":w>=e?Math.round(y/e)+"m":w>=r?Math.round(y/r)+"s":y+"ms"}function p(y){var w=Math.abs(y);return w>=n?g(y,w,n,"day"):w>=t?g(y,w,t,"hour"):w>=e?g(y,w,e,"minute"):w>=r?g(y,w,r,"second"):y+" ms"}function g(y,w,v,C){var A=w>=v*1.5;return Math.round(y/v)+" "+C+(A?"s":"")}return Lt}function di(r){t.debug=t,t.default=t,t.coerce=p,t.disable=c,t.enable=o,t.enabled=l,t.humanize=hi(),t.destroy=g,Object.keys(r).forEach(y=>{t[y]=r[y]}),t.names=[],t.skips=[],t.formatters={};function e(y){let w=0;for(let v=0;v<y.length;v++)w=(w<<5)-w+y.charCodeAt(v),w|=0;return t.colors[Math.abs(w)%t.colors.length]}t.selectColor=e;function t(y){let w,v=null,C,A;function x(...B){if(!x.enabled)return;const _=x,T=Number(new Date),O=T-(w||T);_.diff=O,_.prev=w,_.curr=T,w=T,B[0]=t.coerce(B[0]),typeof B[0]!="string"&&B.unshift("%O");let F=0;B[0]=B[0].replace(/%([a-zA-Z%])/g,(q,X)=>{if(q==="%%")return"%";F++;const H=t.formatters[X];if(typeof H=="function"){const P=B[F];q=H.call(_,P),B.splice(F,1),F--}return q}),t.formatArgs.call(_,B),(_.log||t.log).apply(_,B)}return x.namespace=y,x.useColors=t.useColors(),x.color=t.selectColor(y),x.extend=n,x.destroy=t.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>v!==null?v:(C!==t.namespaces&&(C=t.namespaces,A=t.enabled(y)),A),set:B=>{v=B}}),typeof t.init=="function"&&t.init(x),x}function n(y,w){const v=t(this.namespace+(typeof w>"u"?":":w)+y);return v.log=this.log,v}function o(y){t.save(y),t.namespaces=y,t.names=[],t.skips=[];const w=(typeof y=="string"?y:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const v of w)v[0]==="-"?t.skips.push(v.slice(1)):t.names.push(v)}function a(y,w){let v=0,C=0,A=-1,x=0;for(;v<y.length;)if(C<w.length&&(w[C]===y[v]||w[C]==="*"))w[C]==="*"?(A=C,x=v,C++):(v++,C++);else if(A!==-1)C=A+1,x++,v=x;else return!1;for(;C<w.length&&w[C]==="*";)C++;return C===w.length}function c(){const y=[...t.names,...t.skips.map(w=>"-"+w)].join(",");return t.enable(""),y}function l(y){for(const w of t.skips)if(a(y,w))return!1;for(const w of t.names)if(a(y,w))return!0;return!1}function p(y){return y instanceof Error?y.stack||y.message:y}function g(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}var pi=di;(function(r,e){var t={};e.formatArgs=o,e.save=a,e.load=c,e.useColors=n,e.storage=l(),e.destroy=(()=>{let g=!1;return()=>{g||(g=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let g;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(g=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(g[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(g){if(g[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+g[0]+(this.useColors?"%c ":" ")+"+"+r.exports.humanize(this.diff),!this.useColors)return;const y="color: "+this.color;g.splice(1,0,y,"color: inherit");let w=0,v=0;g[0].replace(/%[a-zA-Z%]/g,C=>{C!=="%%"&&(w++,C==="%c"&&(v=w))}),g.splice(v,0,y)}e.log=console.debug||console.log||(()=>{});function a(g){try{g?e.storage.setItem("debug",g):e.storage.removeItem("debug")}catch{}}function c(){let g;try{g=e.storage.getItem("debug")||e.storage.getItem("DEBUG")}catch{}return!g&&typeof process<"u"&&"env"in process&&(g=t.DEBUG),g}function l(){try{return localStorage}catch{}}r.exports=pi(e);const{formatters:p}=r.exports;p.j=function(g){try{return JSON.stringify(g)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}}})(rr,rr.exports);var gi=rr.exports,yi=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null},nr={exports:{}},ir={exports:{}},st={},At={};At.byteLength=wi;At.toByteArray=Ei;At.fromByteArray=Ci;var Ne=[],Ce=[],_i=typeof Uint8Array<"u"?Uint8Array:Array,Pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ze=0,mi=Pt.length;ze<mi;++ze)Ne[ze]=Pt[ze],Ce[Pt.charCodeAt(ze)]=ze;Ce[45]=62;Ce[95]=63;function un(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function wi(r){var e=un(r),t=e[0],n=e[1];return(t+n)*3/4-n}function bi(r,e,t){return(e+t)*3/4-t}function Ei(r){var e,t=un(r),n=t[0],o=t[1],a=new _i(bi(r,n,o)),c=0,l=o>0?n-4:n,p;for(p=0;p<l;p+=4)e=Ce[r.charCodeAt(p)]<<18|Ce[r.charCodeAt(p+1)]<<12|Ce[r.charCodeAt(p+2)]<<6|Ce[r.charCodeAt(p+3)],a[c++]=e>>16&255,a[c++]=e>>8&255,a[c++]=e&255;return o===2&&(e=Ce[r.charCodeAt(p)]<<2|Ce[r.charCodeAt(p+1)]>>4,a[c++]=e&255),o===1&&(e=Ce[r.charCodeAt(p)]<<10|Ce[r.charCodeAt(p+1)]<<4|Ce[r.charCodeAt(p+2)]>>2,a[c++]=e>>8&255,a[c++]=e&255),a}function Ri(r){return Ne[r>>18&63]+Ne[r>>12&63]+Ne[r>>6&63]+Ne[r&63]}function vi(r,e,t){for(var n,o=[],a=e;a<t;a+=3)n=(r[a]<<16&16711680)+(r[a+1]<<8&65280)+(r[a+2]&255),o.push(Ri(n));return o.join("")}function Ci(r){for(var e,t=r.length,n=t%3,o=[],a=16383,c=0,l=t-n;c<l;c+=a)o.push(vi(r,c,c+a>l?l:c+a));return n===1?(e=r[t-1],o.push(Ne[e>>2]+Ne[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],o.push(Ne[e>>10]+Ne[e>>4&63]+Ne[e<<2&63]+"=")),o.join("")}var pr={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */pr.read=function(r,e,t,n,o){var a,c,l=o*8-n-1,p=(1<<l)-1,g=p>>1,y=-7,w=t?o-1:0,v=t?-1:1,C=r[e+w];for(w+=v,a=C&(1<<-y)-1,C>>=-y,y+=l;y>0;a=a*256+r[e+w],w+=v,y-=8);for(c=a&(1<<-y)-1,a>>=-y,y+=n;y>0;c=c*256+r[e+w],w+=v,y-=8);if(a===0)a=1-g;else{if(a===p)return c?NaN:(C?-1:1)*(1/0);c=c+Math.pow(2,n),a=a-g}return(C?-1:1)*c*Math.pow(2,a-n)};pr.write=function(r,e,t,n,o,a){var c,l,p,g=a*8-o-1,y=(1<<g)-1,w=y>>1,v=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=n?0:a-1,A=n?1:-1,x=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,c=y):(c=Math.floor(Math.log(e)/Math.LN2),e*(p=Math.pow(2,-c))<1&&(c--,p*=2),c+w>=1?e+=v/p:e+=v*Math.pow(2,1-w),e*p>=2&&(c++,p/=2),c+w>=y?(l=0,c=y):c+w>=1?(l=(e*p-1)*Math.pow(2,o),c=c+w):(l=e*Math.pow(2,w-1)*Math.pow(2,o),c=0));o>=8;r[t+C]=l&255,C+=A,l/=256,o-=8);for(c=c<<o|l,g+=o;g>0;r[t+C]=c&255,C+=A,c/=256,g-=8);r[t+C-A]|=x*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const e=At,t=pr,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=l,r.SlowBuffer=T,r.INSPECT_MAX_BYTES=50;const o=2147483647;r.kMaxLength=o,l.TYPED_ARRAY_SUPPORT=a(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const u=new Uint8Array(1),i={foo:function(){return 42}};return Object.setPrototypeOf(i,Uint8Array.prototype),Object.setPrototypeOf(u,i),u.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function c(u){if(u>o)throw new RangeError('The value "'+u+'" is invalid for option "size"');const i=new Uint8Array(u);return Object.setPrototypeOf(i,l.prototype),i}function l(u,i,s){if(typeof u=="number"){if(typeof i=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(u)}return p(u,i,s)}l.poolSize=8192;function p(u,i,s){if(typeof u=="string")return v(u,i);if(ArrayBuffer.isView(u))return A(u);if(u==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u);if(me(u,ArrayBuffer)||u&&me(u.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(me(u,SharedArrayBuffer)||u&&me(u.buffer,SharedArrayBuffer)))return x(u,i,s);if(typeof u=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const f=u.valueOf&&u.valueOf();if(f!=null&&f!==u)return l.from(f,i,s);const m=B(u);if(m)return m;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof u[Symbol.toPrimitive]=="function")return l.from(u[Symbol.toPrimitive]("string"),i,s);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u)}l.from=function(u,i,s){return p(u,i,s)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function g(u){if(typeof u!="number")throw new TypeError('"size" argument must be of type number');if(u<0)throw new RangeError('The value "'+u+'" is invalid for option "size"')}function y(u,i,s){return g(u),u<=0?c(u):i!==void 0?typeof s=="string"?c(u).fill(i,s):c(u).fill(i):c(u)}l.alloc=function(u,i,s){return y(u,i,s)};function w(u){return g(u),c(u<0?0:_(u)|0)}l.allocUnsafe=function(u){return w(u)},l.allocUnsafeSlow=function(u){return w(u)};function v(u,i){if((typeof i!="string"||i==="")&&(i="utf8"),!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);const s=O(u,i)|0;let f=c(s);const m=f.write(u,i);return m!==s&&(f=f.slice(0,m)),f}function C(u){const i=u.length<0?0:_(u.length)|0,s=c(i);for(let f=0;f<i;f+=1)s[f]=u[f]&255;return s}function A(u){if(me(u,Uint8Array)){const i=new Uint8Array(u);return x(i.buffer,i.byteOffset,i.byteLength)}return C(u)}function x(u,i,s){if(i<0||u.byteLength<i)throw new RangeError('"offset" is outside of buffer bounds');if(u.byteLength<i+(s||0))throw new RangeError('"length" is outside of buffer bounds');let f;return i===void 0&&s===void 0?f=new Uint8Array(u):s===void 0?f=new Uint8Array(u,i):f=new Uint8Array(u,i,s),Object.setPrototypeOf(f,l.prototype),f}function B(u){if(l.isBuffer(u)){const i=_(u.length)|0,s=c(i);return s.length===0||u.copy(s,0,0,i),s}if(u.length!==void 0)return typeof u.length!="number"||qe(u.length)?c(0):C(u);if(u.type==="Buffer"&&Array.isArray(u.data))return C(u.data)}function _(u){if(u>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return u|0}function T(u){return+u!=u&&(u=0),l.alloc(+u)}l.isBuffer=function(i){return i!=null&&i._isBuffer===!0&&i!==l.prototype},l.compare=function(i,s){if(me(i,Uint8Array)&&(i=l.from(i,i.offset,i.byteLength)),me(s,Uint8Array)&&(s=l.from(s,s.offset,s.byteLength)),!l.isBuffer(i)||!l.isBuffer(s))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(i===s)return 0;let f=i.length,m=s.length;for(let E=0,S=Math.min(f,m);E<S;++E)if(i[E]!==s[E]){f=i[E],m=s[E];break}return f<m?-1:m<f?1:0},l.isEncoding=function(i){switch(String(i).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(i,s){if(!Array.isArray(i))throw new TypeError('"list" argument must be an Array of Buffers');if(i.length===0)return l.alloc(0);let f;if(s===void 0)for(s=0,f=0;f<i.length;++f)s+=i[f].length;const m=l.allocUnsafe(s);let E=0;for(f=0;f<i.length;++f){let S=i[f];if(me(S,Uint8Array))E+S.length>m.length?(l.isBuffer(S)||(S=l.from(S)),S.copy(m,E)):Uint8Array.prototype.set.call(m,S,E);else if(l.isBuffer(S))S.copy(m,E);else throw new TypeError('"list" argument must be an Array of Buffers');E+=S.length}return m};function O(u,i){if(l.isBuffer(u))return u.length;if(ArrayBuffer.isView(u)||me(u,ArrayBuffer))return u.byteLength;if(typeof u!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof u);const s=u.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&s===0)return 0;let m=!1;for(;;)switch(i){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":return Q(u).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s*2;case"hex":return s>>>1;case"base64":return at(u).length;default:if(m)return f?-1:Q(u).length;i=(""+i).toLowerCase(),m=!0}}l.byteLength=O;function F(u,i,s){let f=!1;if((i===void 0||i<0)&&(i=0),i>this.length||((s===void 0||s>this.length)&&(s=this.length),s<=0)||(s>>>=0,i>>>=0,s<=i))return"";for(u||(u="utf8");;)switch(u){case"hex":return se(this,i,s);case"utf8":case"utf-8":return Ie(this,i,s);case"ascii":return Z(this,i,s);case"latin1":case"binary":return te(this,i,s);case"base64":return Ee(this,i,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,i,s);default:if(f)throw new TypeError("Unknown encoding: "+u);u=(u+"").toLowerCase(),f=!0}}l.prototype._isBuffer=!0;function L(u,i,s){const f=u[i];u[i]=u[s],u[s]=f}l.prototype.swap16=function(){const i=this.length;if(i%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let s=0;s<i;s+=2)L(this,s,s+1);return this},l.prototype.swap32=function(){const i=this.length;if(i%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let s=0;s<i;s+=4)L(this,s,s+3),L(this,s+1,s+2);return this},l.prototype.swap64=function(){const i=this.length;if(i%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let s=0;s<i;s+=8)L(this,s,s+7),L(this,s+1,s+6),L(this,s+2,s+5),L(this,s+3,s+4);return this},l.prototype.toString=function(){const i=this.length;return i===0?"":arguments.length===0?Ie(this,0,i):F.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(i){if(!l.isBuffer(i))throw new TypeError("Argument must be a Buffer");return this===i?!0:l.compare(this,i)===0},l.prototype.inspect=function(){let i="";const s=r.INSPECT_MAX_BYTES;return i=this.toString("hex",0,s).replace(/(.{2})/g,"$1 ").trim(),this.length>s&&(i+=" ... "),"<Buffer "+i+">"},n&&(l.prototype[n]=l.prototype.inspect),l.prototype.compare=function(i,s,f,m,E){if(me(i,Uint8Array)&&(i=l.from(i,i.offset,i.byteLength)),!l.isBuffer(i))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof i);if(s===void 0&&(s=0),f===void 0&&(f=i?i.length:0),m===void 0&&(m=0),E===void 0&&(E=this.length),s<0||f>i.length||m<0||E>this.length)throw new RangeError("out of range index");if(m>=E&&s>=f)return 0;if(m>=E)return-1;if(s>=f)return 1;if(s>>>=0,f>>>=0,m>>>=0,E>>>=0,this===i)return 0;let S=E-m,K=f-s;const ae=Math.min(S,K),ie=this.slice(m,E),ue=i.slice(s,f);for(let $=0;$<ae;++$)if(ie[$]!==ue[$]){S=ie[$],K=ue[$];break}return S<K?-1:K<S?1:0};function q(u,i,s,f,m){if(u.length===0)return-1;if(typeof s=="string"?(f=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,qe(s)&&(s=m?0:u.length-1),s<0&&(s=u.length+s),s>=u.length){if(m)return-1;s=u.length-1}else if(s<0)if(m)s=0;else return-1;if(typeof i=="string"&&(i=l.from(i,f)),l.isBuffer(i))return i.length===0?-1:X(u,i,s,f,m);if(typeof i=="number")return i=i&255,typeof Uint8Array.prototype.indexOf=="function"?m?Uint8Array.prototype.indexOf.call(u,i,s):Uint8Array.prototype.lastIndexOf.call(u,i,s):X(u,[i],s,f,m);throw new TypeError("val must be string, number or Buffer")}function X(u,i,s,f,m){let E=1,S=u.length,K=i.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(u.length<2||i.length<2)return-1;E=2,S/=2,K/=2,s/=2}function ae(ue,$){return E===1?ue[$]:ue.readUInt16BE($*E)}let ie;if(m){let ue=-1;for(ie=s;ie<S;ie++)if(ae(u,ie)===ae(i,ue===-1?0:ie-ue)){if(ue===-1&&(ue=ie),ie-ue+1===K)return ue*E}else ue!==-1&&(ie-=ie-ue),ue=-1}else for(s+K>S&&(s=S-K),ie=s;ie>=0;ie--){let ue=!0;for(let $=0;$<K;$++)if(ae(u,ie+$)!==ae(i,$)){ue=!1;break}if(ue)return ie}return-1}l.prototype.includes=function(i,s,f){return this.indexOf(i,s,f)!==-1},l.prototype.indexOf=function(i,s,f){return q(this,i,s,f,!0)},l.prototype.lastIndexOf=function(i,s,f){return q(this,i,s,f,!1)};function H(u,i,s,f){s=Number(s)||0;const m=u.length-s;f?(f=Number(f),f>m&&(f=m)):f=m;const E=i.length;f>E/2&&(f=E/2);let S;for(S=0;S<f;++S){const K=parseInt(i.substr(S*2,2),16);if(qe(K))return S;u[s+S]=K}return S}function P(u,i,s,f){return Ge(Q(i,u.length-s),u,s,f)}function pe(u,i,s,f){return Ge(Me(i),u,s,f)}function he(u,i,s,f){return Ge(at(i),u,s,f)}function be(u,i,s,f){return Ge(Ke(i,u.length-s),u,s,f)}l.prototype.write=function(i,s,f,m){if(s===void 0)m="utf8",f=this.length,s=0;else if(f===void 0&&typeof s=="string")m=s,f=this.length,s=0;else if(isFinite(s))s=s>>>0,isFinite(f)?(f=f>>>0,m===void 0&&(m="utf8")):(m=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const E=this.length-s;if((f===void 0||f>E)&&(f=E),i.length>0&&(f<0||s<0)||s>this.length)throw new RangeError("Attempt to write outside buffer bounds");m||(m="utf8");let S=!1;for(;;)switch(m){case"hex":return H(this,i,s,f);case"utf8":case"utf-8":return P(this,i,s,f);case"ascii":case"latin1":case"binary":return pe(this,i,s,f);case"base64":return he(this,i,s,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return be(this,i,s,f);default:if(S)throw new TypeError("Unknown encoding: "+m);m=(""+m).toLowerCase(),S=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ee(u,i,s){return i===0&&s===u.length?e.fromByteArray(u):e.fromByteArray(u.slice(i,s))}function Ie(u,i,s){s=Math.min(u.length,s);const f=[];let m=i;for(;m<s;){const E=u[m];let S=null,K=E>239?4:E>223?3:E>191?2:1;if(m+K<=s){let ae,ie,ue,$;switch(K){case 1:E<128&&(S=E);break;case 2:ae=u[m+1],(ae&192)===128&&($=(E&31)<<6|ae&63,$>127&&(S=$));break;case 3:ae=u[m+1],ie=u[m+2],(ae&192)===128&&(ie&192)===128&&($=(E&15)<<12|(ae&63)<<6|ie&63,$>2047&&($<55296||$>57343)&&(S=$));break;case 4:ae=u[m+1],ie=u[m+2],ue=u[m+3],(ae&192)===128&&(ie&192)===128&&(ue&192)===128&&($=(E&15)<<18|(ae&63)<<12|(ie&63)<<6|ue&63,$>65535&&$<1114112&&(S=$))}}S===null?(S=65533,K=1):S>65535&&(S-=65536,f.push(S>>>10&1023|55296),S=56320|S&1023),f.push(S),m+=K}return re(f)}const oe=4096;function re(u){const i=u.length;if(i<=oe)return String.fromCharCode.apply(String,u);let s="",f=0;for(;f<i;)s+=String.fromCharCode.apply(String,u.slice(f,f+=oe));return s}function Z(u,i,s){let f="";s=Math.min(u.length,s);for(let m=i;m<s;++m)f+=String.fromCharCode(u[m]&127);return f}function te(u,i,s){let f="";s=Math.min(u.length,s);for(let m=i;m<s;++m)f+=String.fromCharCode(u[m]);return f}function se(u,i,s){const f=u.length;(!i||i<0)&&(i=0),(!s||s<0||s>f)&&(s=f);let m="";for(let E=i;E<s;++E)m+=ut[u[E]];return m}function le(u,i,s){const f=u.slice(i,s);let m="";for(let E=0;E<f.length-1;E+=2)m+=String.fromCharCode(f[E]+f[E+1]*256);return m}l.prototype.slice=function(i,s){const f=this.length;i=~~i,s=s===void 0?f:~~s,i<0?(i+=f,i<0&&(i=0)):i>f&&(i=f),s<0?(s+=f,s<0&&(s=0)):s>f&&(s=f),s<i&&(s=i);const m=this.subarray(i,s);return Object.setPrototypeOf(m,l.prototype),m};function M(u,i,s){if(u%1!==0||u<0)throw new RangeError("offset is not uint");if(u+i>s)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let m=this[i],E=1,S=0;for(;++S<s&&(E*=256);)m+=this[i+S]*E;return m},l.prototype.readUintBE=l.prototype.readUIntBE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let m=this[i+--s],E=1;for(;s>0&&(E*=256);)m+=this[i+--s]*E;return m},l.prototype.readUint8=l.prototype.readUInt8=function(i,s){return i=i>>>0,s||M(i,1,this.length),this[i]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(i,s){return i=i>>>0,s||M(i,2,this.length),this[i]|this[i+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(i,s){return i=i>>>0,s||M(i,2,this.length),this[i]<<8|this[i+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(i,s){return i=i>>>0,s||M(i,4,this.length),(this[i]|this[i+1]<<8|this[i+2]<<16)+this[i+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(i,s){return i=i>>>0,s||M(i,4,this.length),this[i]*16777216+(this[i+1]<<16|this[i+2]<<8|this[i+3])},l.prototype.readBigUInt64LE=Re(function(i){i=i>>>0,k(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&D(i,this.length-8);const m=s+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24,E=this[++i]+this[++i]*2**8+this[++i]*2**16+f*2**24;return BigInt(m)+(BigInt(E)<<BigInt(32))}),l.prototype.readBigUInt64BE=Re(function(i){i=i>>>0,k(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&D(i,this.length-8);const m=s*2**24+this[++i]*2**16+this[++i]*2**8+this[++i],E=this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+f;return(BigInt(m)<<BigInt(32))+BigInt(E)}),l.prototype.readIntLE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let m=this[i],E=1,S=0;for(;++S<s&&(E*=256);)m+=this[i+S]*E;return E*=128,m>=E&&(m-=Math.pow(2,8*s)),m},l.prototype.readIntBE=function(i,s,f){i=i>>>0,s=s>>>0,f||M(i,s,this.length);let m=s,E=1,S=this[i+--m];for(;m>0&&(E*=256);)S+=this[i+--m]*E;return E*=128,S>=E&&(S-=Math.pow(2,8*s)),S},l.prototype.readInt8=function(i,s){return i=i>>>0,s||M(i,1,this.length),this[i]&128?(255-this[i]+1)*-1:this[i]},l.prototype.readInt16LE=function(i,s){i=i>>>0,s||M(i,2,this.length);const f=this[i]|this[i+1]<<8;return f&32768?f|4294901760:f},l.prototype.readInt16BE=function(i,s){i=i>>>0,s||M(i,2,this.length);const f=this[i+1]|this[i]<<8;return f&32768?f|4294901760:f},l.prototype.readInt32LE=function(i,s){return i=i>>>0,s||M(i,4,this.length),this[i]|this[i+1]<<8|this[i+2]<<16|this[i+3]<<24},l.prototype.readInt32BE=function(i,s){return i=i>>>0,s||M(i,4,this.length),this[i]<<24|this[i+1]<<16|this[i+2]<<8|this[i+3]},l.prototype.readBigInt64LE=Re(function(i){i=i>>>0,k(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&D(i,this.length-8);const m=this[i+4]+this[i+5]*2**8+this[i+6]*2**16+(f<<24);return(BigInt(m)<<BigInt(32))+BigInt(s+this[++i]*2**8+this[++i]*2**16+this[++i]*2**24)}),l.prototype.readBigInt64BE=Re(function(i){i=i>>>0,k(i,"offset");const s=this[i],f=this[i+7];(s===void 0||f===void 0)&&D(i,this.length-8);const m=(s<<24)+this[++i]*2**16+this[++i]*2**8+this[++i];return(BigInt(m)<<BigInt(32))+BigInt(this[++i]*2**24+this[++i]*2**16+this[++i]*2**8+f)}),l.prototype.readFloatLE=function(i,s){return i=i>>>0,s||M(i,4,this.length),t.read(this,i,!0,23,4)},l.prototype.readFloatBE=function(i,s){return i=i>>>0,s||M(i,4,this.length),t.read(this,i,!1,23,4)},l.prototype.readDoubleLE=function(i,s){return i=i>>>0,s||M(i,8,this.length),t.read(this,i,!0,52,8)},l.prototype.readDoubleBE=function(i,s){return i=i>>>0,s||M(i,8,this.length),t.read(this,i,!1,52,8)};function G(u,i,s,f,m,E){if(!l.isBuffer(u))throw new TypeError('"buffer" argument must be a Buffer instance');if(i>m||i<E)throw new RangeError('"value" argument is out of bounds');if(s+f>u.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(i,s,f,m){if(i=+i,s=s>>>0,f=f>>>0,!m){const K=Math.pow(2,8*f)-1;G(this,i,s,f,K,0)}let E=1,S=0;for(this[s]=i&255;++S<f&&(E*=256);)this[s+S]=i/E&255;return s+f},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(i,s,f,m){if(i=+i,s=s>>>0,f=f>>>0,!m){const K=Math.pow(2,8*f)-1;G(this,i,s,f,K,0)}let E=f-1,S=1;for(this[s+E]=i&255;--E>=0&&(S*=256);)this[s+E]=i/S&255;return s+f},l.prototype.writeUint8=l.prototype.writeUInt8=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,1,255,0),this[s]=i&255,s+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,2,65535,0),this[s]=i&255,this[s+1]=i>>>8,s+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,2,65535,0),this[s]=i>>>8,this[s+1]=i&255,s+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,4,4294967295,0),this[s+3]=i>>>24,this[s+2]=i>>>16,this[s+1]=i>>>8,this[s]=i&255,s+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,4,4294967295,0),this[s]=i>>>24,this[s+1]=i>>>16,this[s+2]=i>>>8,this[s+3]=i&255,s+4};function _e(u,i,s,f,m){d(i,f,m,u,s,7);let E=Number(i&BigInt(4294967295));u[s++]=E,E=E>>8,u[s++]=E,E=E>>8,u[s++]=E,E=E>>8,u[s++]=E;let S=Number(i>>BigInt(32)&BigInt(4294967295));return u[s++]=S,S=S>>8,u[s++]=S,S=S>>8,u[s++]=S,S=S>>8,u[s++]=S,s}function ke(u,i,s,f,m){d(i,f,m,u,s,7);let E=Number(i&BigInt(4294967295));u[s+7]=E,E=E>>8,u[s+6]=E,E=E>>8,u[s+5]=E,E=E>>8,u[s+4]=E;let S=Number(i>>BigInt(32)&BigInt(4294967295));return u[s+3]=S,S=S>>8,u[s+2]=S,S=S>>8,u[s+1]=S,S=S>>8,u[s]=S,s+8}l.prototype.writeBigUInt64LE=Re(function(i,s=0){return _e(this,i,s,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=Re(function(i,s=0){return ke(this,i,s,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(i,s,f,m){if(i=+i,s=s>>>0,!m){const ae=Math.pow(2,8*f-1);G(this,i,s,f,ae-1,-ae)}let E=0,S=1,K=0;for(this[s]=i&255;++E<f&&(S*=256);)i<0&&K===0&&this[s+E-1]!==0&&(K=1),this[s+E]=(i/S>>0)-K&255;return s+f},l.prototype.writeIntBE=function(i,s,f,m){if(i=+i,s=s>>>0,!m){const ae=Math.pow(2,8*f-1);G(this,i,s,f,ae-1,-ae)}let E=f-1,S=1,K=0;for(this[s+E]=i&255;--E>=0&&(S*=256);)i<0&&K===0&&this[s+E+1]!==0&&(K=1),this[s+E]=(i/S>>0)-K&255;return s+f},l.prototype.writeInt8=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,1,127,-128),i<0&&(i=255+i+1),this[s]=i&255,s+1},l.prototype.writeInt16LE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,2,32767,-32768),this[s]=i&255,this[s+1]=i>>>8,s+2},l.prototype.writeInt16BE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,2,32767,-32768),this[s]=i>>>8,this[s+1]=i&255,s+2},l.prototype.writeInt32LE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,4,2147483647,-2147483648),this[s]=i&255,this[s+1]=i>>>8,this[s+2]=i>>>16,this[s+3]=i>>>24,s+4},l.prototype.writeInt32BE=function(i,s,f){return i=+i,s=s>>>0,f||G(this,i,s,4,2147483647,-2147483648),i<0&&(i=4294967295+i+1),this[s]=i>>>24,this[s+1]=i>>>16,this[s+2]=i>>>8,this[s+3]=i&255,s+4},l.prototype.writeBigInt64LE=Re(function(i,s=0){return _e(this,i,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=Re(function(i,s=0){return ke(this,i,s,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ye(u,i,s,f,m,E){if(s+f>u.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function R(u,i,s,f,m){return i=+i,s=s>>>0,m||Ye(u,i,s,4),t.write(u,i,s,f,23,4),s+4}l.prototype.writeFloatLE=function(i,s,f){return R(this,i,s,!0,f)},l.prototype.writeFloatBE=function(i,s,f){return R(this,i,s,!1,f)};function b(u,i,s,f,m){return i=+i,s=s>>>0,m||Ye(u,i,s,8),t.write(u,i,s,f,52,8),s+8}l.prototype.writeDoubleLE=function(i,s,f){return b(this,i,s,!0,f)},l.prototype.writeDoubleBE=function(i,s,f){return b(this,i,s,!1,f)},l.prototype.copy=function(i,s,f,m){if(!l.isBuffer(i))throw new TypeError("argument should be a Buffer");if(f||(f=0),!m&&m!==0&&(m=this.length),s>=i.length&&(s=i.length),s||(s=0),m>0&&m<f&&(m=f),m===f||i.length===0||this.length===0)return 0;if(s<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(m<0)throw new RangeError("sourceEnd out of bounds");m>this.length&&(m=this.length),i.length-s<m-f&&(m=i.length-s+f);const E=m-f;return this===i&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(s,f,m):Uint8Array.prototype.set.call(i,this.subarray(f,m),s),E},l.prototype.fill=function(i,s,f,m){if(typeof i=="string"){if(typeof s=="string"?(m=s,s=0,f=this.length):typeof f=="string"&&(m=f,f=this.length),m!==void 0&&typeof m!="string")throw new TypeError("encoding must be a string");if(typeof m=="string"&&!l.isEncoding(m))throw new TypeError("Unknown encoding: "+m);if(i.length===1){const S=i.charCodeAt(0);(m==="utf8"&&S<128||m==="latin1")&&(i=S)}}else typeof i=="number"?i=i&255:typeof i=="boolean"&&(i=Number(i));if(s<0||this.length<s||this.length<f)throw new RangeError("Out of range index");if(f<=s)return this;s=s>>>0,f=f===void 0?this.length:f>>>0,i||(i=0);let E;if(typeof i=="number")for(E=s;E<f;++E)this[E]=i;else{const S=l.isBuffer(i)?i:l.from(i,m),K=S.length;if(K===0)throw new TypeError('The value "'+i+'" is invalid for argument "value"');for(E=0;E<f-s;++E)this[E+s]=S[E%K]}return this};const N={};function j(u,i,s){N[u]=class extends s{constructor(){super(),Object.defineProperty(this,"message",{value:i.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${u}]`,this.stack,delete this.name}get code(){return u}set code(m){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:m,writable:!0})}toString(){return`${this.name} [${u}]: ${this.message}`}}}j("ERR_BUFFER_OUT_OF_BOUNDS",function(u){return u?`${u} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),j("ERR_INVALID_ARG_TYPE",function(u,i){return`The "${u}" argument must be of type number. Received type ${typeof i}`},TypeError),j("ERR_OUT_OF_RANGE",function(u,i,s){let f=`The value of "${u}" is out of range.`,m=s;return Number.isInteger(s)&&Math.abs(s)>2**32?m=V(String(s)):typeof s=="bigint"&&(m=String(s),(s>BigInt(2)**BigInt(32)||s<-(BigInt(2)**BigInt(32)))&&(m=V(m)),m+="n"),f+=` It must be ${i}. Received ${m}`,f},RangeError);function V(u){let i="",s=u.length;const f=u[0]==="-"?1:0;for(;s>=f+4;s-=3)i=`_${u.slice(s-3,s)}${i}`;return`${u.slice(0,s)}${i}`}function h(u,i,s){k(i,"offset"),(u[i]===void 0||u[i+s]===void 0)&&D(i,u.length-(s+1))}function d(u,i,s,f,m,E){if(u>s||u<i){const S=typeof i=="bigint"?"n":"";let K;throw i===0||i===BigInt(0)?K=`>= 0${S} and < 2${S} ** ${(E+1)*8}${S}`:K=`>= -(2${S} ** ${(E+1)*8-1}${S}) and < 2 ** ${(E+1)*8-1}${S}`,new N.ERR_OUT_OF_RANGE("value",K,u)}h(f,m,E)}function k(u,i){if(typeof u!="number")throw new N.ERR_INVALID_ARG_TYPE(i,"number",u)}function D(u,i,s){throw Math.floor(u)!==u?(k(u,s),new N.ERR_OUT_OF_RANGE("offset","an integer",u)):i<0?new N.ERR_BUFFER_OUT_OF_BOUNDS:new N.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${i}`,u)}const ne=/[^+/0-9A-Za-z-_]/g;function Y(u){if(u=u.split("=")[0],u=u.trim().replace(ne,""),u.length<2)return"";for(;u.length%4!==0;)u=u+"=";return u}function Q(u,i){i=i||1/0;let s;const f=u.length;let m=null;const E=[];for(let S=0;S<f;++S){if(s=u.charCodeAt(S),s>55295&&s<57344){if(!m){if(s>56319){(i-=3)>-1&&E.push(239,191,189);continue}else if(S+1===f){(i-=3)>-1&&E.push(239,191,189);continue}m=s;continue}if(s<56320){(i-=3)>-1&&E.push(239,191,189),m=s;continue}s=(m-55296<<10|s-56320)+65536}else m&&(i-=3)>-1&&E.push(239,191,189);if(m=null,s<128){if((i-=1)<0)break;E.push(s)}else if(s<2048){if((i-=2)<0)break;E.push(s>>6|192,s&63|128)}else if(s<65536){if((i-=3)<0)break;E.push(s>>12|224,s>>6&63|128,s&63|128)}else if(s<1114112){if((i-=4)<0)break;E.push(s>>18|240,s>>12&63|128,s>>6&63|128,s&63|128)}else throw new Error("Invalid code point")}return E}function Me(u){const i=[];for(let s=0;s<u.length;++s)i.push(u.charCodeAt(s)&255);return i}function Ke(u,i){let s,f,m;const E=[];for(let S=0;S<u.length&&!((i-=2)<0);++S)s=u.charCodeAt(S),f=s>>8,m=s%256,E.push(m),E.push(f);return E}function at(u){return e.toByteArray(Y(u))}function Ge(u,i,s,f){let m;for(m=0;m<f&&!(m+s>=i.length||m>=u.length);++m)i[m+s]=u[m];return m}function me(u,i){return u instanceof i||u!=null&&u.constructor!=null&&u.constructor.name!=null&&u.constructor.name===i.name}function qe(u){return u!==u}const ut=function(){const u="0123456789abcdef",i=new Array(256);for(let s=0;s<16;++s){const f=s*16;for(let m=0;m<16;++m)i[f+m]=u[s]+u[m]}return i}();function Re(u){return typeof BigInt>"u"?je:u}function je(){throw new Error("BigInt not supported")}})(st);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(r,e){var t=st,n=t.Buffer;function o(c,l){for(var p in c)l[p]=c[p]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?r.exports=t:(o(t,e),e.Buffer=a);function a(c,l,p){return n(c,l,p)}a.prototype=Object.create(n.prototype),o(n,a),a.from=function(c,l,p){if(typeof c=="number")throw new TypeError("Argument must not be a number");return n(c,l,p)},a.alloc=function(c,l,p){if(typeof c!="number")throw new TypeError("Argument must be a number");var g=n(c);return l!==void 0?typeof p=="string"?g.fill(l,p):g.fill(l):g.fill(0),g},a.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return n(c)},a.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(c)}})(ir,ir.exports);var ln=ir.exports,Dt=65536,Ti=4294967295;function Si(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var Ai=ln.Buffer,Ct=Pe.crypto||Pe.msCrypto;Ct&&Ct.getRandomValues?nr.exports=xi:nr.exports=Si;function xi(r,e){if(r>Ti)throw new RangeError("requested too many random bytes");var t=Ai.allocUnsafe(r);if(r>0)if(r>Dt)for(var n=0;n<r;n+=Dt)Ct.getRandomValues(t.slice(n,n+Dt));else Ct.getRandomValues(t);return typeof e=="function"?process.nextTick(function(){e(null,t)}):t}var Bi=nr.exports,sr={exports:{}};const ki={},Ni=Object.freeze(Object.defineProperty({__proto__:null,default:ki},Symbol.toStringTag,{value:"Module"})),Tt=fi(Ni);var cn=Tt.EventEmitter,Mt,Sr;function Oi(){if(Sr)return Mt;Sr=1;function r(A,x){var B=Object.keys(A);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(A);x&&(_=_.filter(function(T){return Object.getOwnPropertyDescriptor(A,T).enumerable})),B.push.apply(B,_)}return B}function e(A){for(var x=1;x<arguments.length;x++){var B=arguments[x]!=null?arguments[x]:{};x%2?r(Object(B),!0).forEach(function(_){t(A,_,B[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(B)):r(Object(B)).forEach(function(_){Object.defineProperty(A,_,Object.getOwnPropertyDescriptor(B,_))})}return A}function t(A,x,B){return x=c(x),x in A?Object.defineProperty(A,x,{value:B,enumerable:!0,configurable:!0,writable:!0}):A[x]=B,A}function n(A,x){if(!(A instanceof x))throw new TypeError("Cannot call a class as a function")}function o(A,x){for(var B=0;B<x.length;B++){var _=x[B];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(A,c(_.key),_)}}function a(A,x,B){return x&&o(A.prototype,x),Object.defineProperty(A,"prototype",{writable:!1}),A}function c(A){var x=l(A,"string");return typeof x=="symbol"?x:String(x)}function l(A,x){if(typeof A!="object"||A===null)return A;var B=A[Symbol.toPrimitive];if(B!==void 0){var _=B.call(A,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(A)}var p=st,g=p.Buffer,y=Tt,w=y.inspect,v=w&&w.custom||"inspect";function C(A,x,B){g.prototype.copy.call(A,x,B)}return Mt=function(){function A(){n(this,A),this.head=null,this.tail=null,this.length=0}return a(A,[{key:"push",value:function(B){var _={data:B,next:null};this.length>0?this.tail.next=_:this.head=_,this.tail=_,++this.length}},{key:"unshift",value:function(B){var _={data:B,next:this.head};this.length===0&&(this.tail=_),this.head=_,++this.length}},{key:"shift",value:function(){if(this.length!==0){var B=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,B}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(B){if(this.length===0)return"";for(var _=this.head,T=""+_.data;_=_.next;)T+=B+_.data;return T}},{key:"concat",value:function(B){if(this.length===0)return g.alloc(0);for(var _=g.allocUnsafe(B>>>0),T=this.head,O=0;T;)C(T.data,_,O),O+=T.data.length,T=T.next;return _}},{key:"consume",value:function(B,_){var T;return B<this.head.data.length?(T=this.head.data.slice(0,B),this.head.data=this.head.data.slice(B)):B===this.head.data.length?T=this.shift():T=_?this._getString(B):this._getBuffer(B),T}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(B){var _=this.head,T=1,O=_.data;for(B-=O.length;_=_.next;){var F=_.data,L=B>F.length?F.length:B;if(L===F.length?O+=F:O+=F.slice(0,B),B-=L,B===0){L===F.length?(++T,_.next?this.head=_.next:this.head=this.tail=null):(this.head=_,_.data=F.slice(L));break}++T}return this.length-=T,O}},{key:"_getBuffer",value:function(B){var _=g.allocUnsafe(B),T=this.head,O=1;for(T.data.copy(_),B-=T.data.length;T=T.next;){var F=T.data,L=B>F.length?F.length:B;if(F.copy(_,_.length-B,0,L),B-=L,B===0){L===F.length?(++O,T.next?this.head=T.next:this.head=this.tail=null):(this.head=T,T.data=F.slice(L));break}++O}return this.length-=O,_}},{key:v,value:function(B,_){return w(this,e(e({},_),{},{depth:0,customInspect:!1}))}}]),A}(),Mt}function Fi(r,e){var t=this,n=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return n||o?(e?e(r):r&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(or,this,r)):process.nextTick(or,this,r)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(r||null,function(a){!e&&a?t._writableState?t._writableState.errorEmitted?process.nextTick(wt,t):(t._writableState.errorEmitted=!0,process.nextTick(Ar,t,a)):process.nextTick(Ar,t,a):e?(process.nextTick(wt,t),e(a)):process.nextTick(wt,t)}),this)}function Ar(r,e){or(r,e),wt(r)}function wt(r){r._writableState&&!r._writableState.emitClose||r._readableState&&!r._readableState.emitClose||r.emit("close")}function Ii(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function or(r,e){r.emit("error",e)}function Li(r,e){var t=r._readableState,n=r._writableState;t&&t.autoDestroy||n&&n.autoDestroy?r.destroy(e):r.emit("error",e)}var fn={destroy:Fi,undestroy:Ii,errorOrDestroy:Li},Ve={};function Pi(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var hn={};function Ae(r,e,t){t||(t=Error);function n(a,c,l){return typeof e=="string"?e:e(a,c,l)}var o=function(a){Pi(c,a);function c(l,p,g){return a.call(this,n(l,p,g))||this}return c}(t);o.prototype.name=t.name,o.prototype.code=r,hn[r]=o}function xr(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(n){return String(n)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:t===2?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}else return"of ".concat(e," ").concat(String(r))}function Di(r,e,t){return r.substr(0,e.length)===e}function Mi(r,e,t){return(t===void 0||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function Ui(r,e,t){return typeof t!="number"&&(t=0),t+e.length>r.length?!1:r.indexOf(e,t)!==-1}Ae("ERR_INVALID_OPT_VALUE",function(r,e){return'The value "'+e+'" is invalid for option "'+r+'"'},TypeError);Ae("ERR_INVALID_ARG_TYPE",function(r,e,t){var n;typeof e=="string"&&Di(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var o;if(Mi(r," argument"))o="The ".concat(r," ").concat(n," ").concat(xr(e,"type"));else{var a=Ui(r,".")?"property":"argument";o='The "'.concat(r,'" ').concat(a," ").concat(n," ").concat(xr(e,"type"))}return o+=". Received type ".concat(typeof t),o},TypeError);Ae("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Ae("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"});Ae("ERR_STREAM_PREMATURE_CLOSE","Premature close");Ae("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"});Ae("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Ae("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Ae("ERR_STREAM_WRITE_AFTER_END","write after end");Ae("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Ae("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError);Ae("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");Ve.codes=hn;var qi=Ve.codes.ERR_INVALID_OPT_VALUE;function ji(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function Wi(r,e,t,n){var o=ji(e,n,t);if(o!=null){if(!(isFinite(o)&&Math.floor(o)===o)||o<0){var a=n?t:"highWaterMark";throw new qi(a,o)}return Math.floor(o)}return r.objectMode?16:16*1024}var dn={getHighWaterMark:Wi},ar={exports:{}};typeof Object.create=="function"?ar.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ar.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}};var gt=ar.exports,Hi=Vi;function Vi(r,e){if(Ut("noDeprecation"))return r;var t=!1;function n(){if(!t){if(Ut("throwDeprecation"))throw new Error(e);Ut("traceDeprecation")?console.trace(e):console.warn(e),t=!0}return r.apply(this,arguments)}return n}function Ut(r){try{if(!Pe.localStorage)return!1}catch{return!1}var e=Pe.localStorage[r];return e==null?!1:String(e).toLowerCase()==="true"}var qt,Br;function pn(){if(Br)return qt;Br=1,qt=H;function r(R){var b=this;this.next=null,this.entry=null,this.finish=function(){Ye(b,R)}}var e;H.WritableState=q;var t={deprecate:Hi},n=cn,o=st.Buffer,a=(typeof Pe<"u"?Pe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function c(R){return o.from(R)}function l(R){return o.isBuffer(R)||R instanceof a}var p=fn,g=dn,y=g.getHighWaterMark,w=Ve.codes,v=w.ERR_INVALID_ARG_TYPE,C=w.ERR_METHOD_NOT_IMPLEMENTED,A=w.ERR_MULTIPLE_CALLBACK,x=w.ERR_STREAM_CANNOT_PIPE,B=w.ERR_STREAM_DESTROYED,_=w.ERR_STREAM_NULL_VALUES,T=w.ERR_STREAM_WRITE_AFTER_END,O=w.ERR_UNKNOWN_ENCODING,F=p.errorOrDestroy;gt(H,n);function L(){}function q(R,b,N){e=e||et(),R=R||{},typeof N!="boolean"&&(N=b instanceof e),this.objectMode=!!R.objectMode,N&&(this.objectMode=this.objectMode||!!R.writableObjectMode),this.highWaterMark=y(this,R,"writableHighWaterMark",N),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var j=R.decodeStrings===!1;this.decodeStrings=!j,this.defaultEncoding=R.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(V){re(b,V)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=R.emitClose!==!1,this.autoDestroy=!!R.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}q.prototype.getBuffer=function(){for(var b=this.bufferedRequest,N=[];b;)N.push(b),b=b.next;return N},function(){try{Object.defineProperty(q.prototype,"buffer",{get:t.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var X;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(X=Function.prototype[Symbol.hasInstance],Object.defineProperty(H,Symbol.hasInstance,{value:function(b){return X.call(this,b)?!0:this!==H?!1:b&&b._writableState instanceof q}})):X=function(b){return b instanceof this};function H(R){e=e||et();var b=this instanceof e;if(!b&&!X.call(H,this))return new H(R);this._writableState=new q(R,this,b),this.writable=!0,R&&(typeof R.write=="function"&&(this._write=R.write),typeof R.writev=="function"&&(this._writev=R.writev),typeof R.destroy=="function"&&(this._destroy=R.destroy),typeof R.final=="function"&&(this._final=R.final)),n.call(this)}H.prototype.pipe=function(){F(this,new x)};function P(R,b){var N=new T;F(R,N),process.nextTick(b,N)}function pe(R,b,N,j){var V;return N===null?V=new _:typeof N!="string"&&!b.objectMode&&(V=new v("chunk",["string","Buffer"],N)),V?(F(R,V),process.nextTick(j,V),!1):!0}H.prototype.write=function(R,b,N){var j=this._writableState,V=!1,h=!j.objectMode&&l(R);return h&&!o.isBuffer(R)&&(R=c(R)),typeof b=="function"&&(N=b,b=null),h?b="buffer":b||(b=j.defaultEncoding),typeof N!="function"&&(N=L),j.ending?P(this,N):(h||pe(this,j,R,N))&&(j.pendingcb++,V=be(this,j,h,R,b,N)),V},H.prototype.cork=function(){this._writableState.corked++},H.prototype.uncork=function(){var R=this._writableState;R.corked&&(R.corked--,!R.writing&&!R.corked&&!R.bufferProcessing&&R.bufferedRequest&&se(this,R))},H.prototype.setDefaultEncoding=function(b){if(typeof b=="string"&&(b=b.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((b+"").toLowerCase())>-1))throw new O(b);return this._writableState.defaultEncoding=b,this},Object.defineProperty(H.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function he(R,b,N){return!R.objectMode&&R.decodeStrings!==!1&&typeof b=="string"&&(b=o.from(b,N)),b}Object.defineProperty(H.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function be(R,b,N,j,V,h){if(!N){var d=he(b,j,V);j!==d&&(N=!0,V="buffer",j=d)}var k=b.objectMode?1:j.length;b.length+=k;var D=b.length<b.highWaterMark;if(D||(b.needDrain=!0),b.writing||b.corked){var ne=b.lastBufferedRequest;b.lastBufferedRequest={chunk:j,encoding:V,isBuf:N,callback:h,next:null},ne?ne.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest,b.bufferedRequestCount+=1}else Ee(R,b,!1,k,j,V,h);return D}function Ee(R,b,N,j,V,h,d){b.writelen=j,b.writecb=d,b.writing=!0,b.sync=!0,b.destroyed?b.onwrite(new B("write")):N?R._writev(V,b.onwrite):R._write(V,h,b.onwrite),b.sync=!1}function Ie(R,b,N,j,V){--b.pendingcb,N?(process.nextTick(V,j),process.nextTick(_e,R,b),R._writableState.errorEmitted=!0,F(R,j)):(V(j),R._writableState.errorEmitted=!0,F(R,j),_e(R,b))}function oe(R){R.writing=!1,R.writecb=null,R.length-=R.writelen,R.writelen=0}function re(R,b){var N=R._writableState,j=N.sync,V=N.writecb;if(typeof V!="function")throw new A;if(oe(N),b)Ie(R,N,j,b,V);else{var h=le(N)||R.destroyed;!h&&!N.corked&&!N.bufferProcessing&&N.bufferedRequest&&se(R,N),j?process.nextTick(Z,R,N,h,V):Z(R,N,h,V)}}function Z(R,b,N,j){N||te(R,b),b.pendingcb--,j(),_e(R,b)}function te(R,b){b.length===0&&b.needDrain&&(b.needDrain=!1,R.emit("drain"))}function se(R,b){b.bufferProcessing=!0;var N=b.bufferedRequest;if(R._writev&&N&&N.next){var j=b.bufferedRequestCount,V=new Array(j),h=b.corkedRequestsFree;h.entry=N;for(var d=0,k=!0;N;)V[d]=N,N.isBuf||(k=!1),N=N.next,d+=1;V.allBuffers=k,Ee(R,b,!0,b.length,V,"",h.finish),b.pendingcb++,b.lastBufferedRequest=null,h.next?(b.corkedRequestsFree=h.next,h.next=null):b.corkedRequestsFree=new r(b),b.bufferedRequestCount=0}else{for(;N;){var D=N.chunk,ne=N.encoding,Y=N.callback,Q=b.objectMode?1:D.length;if(Ee(R,b,!1,Q,D,ne,Y),N=N.next,b.bufferedRequestCount--,b.writing)break}N===null&&(b.lastBufferedRequest=null)}b.bufferedRequest=N,b.bufferProcessing=!1}H.prototype._write=function(R,b,N){N(new C("_write()"))},H.prototype._writev=null,H.prototype.end=function(R,b,N){var j=this._writableState;return typeof R=="function"?(N=R,R=null,b=null):typeof b=="function"&&(N=b,b=null),R!=null&&this.write(R,b),j.corked&&(j.corked=1,this.uncork()),j.ending||ke(this,j,N),this},Object.defineProperty(H.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function le(R){return R.ending&&R.length===0&&R.bufferedRequest===null&&!R.finished&&!R.writing}function M(R,b){R._final(function(N){b.pendingcb--,N&&F(R,N),b.prefinished=!0,R.emit("prefinish"),_e(R,b)})}function G(R,b){!b.prefinished&&!b.finalCalled&&(typeof R._final=="function"&&!b.destroyed?(b.pendingcb++,b.finalCalled=!0,process.nextTick(M,R,b)):(b.prefinished=!0,R.emit("prefinish")))}function _e(R,b){var N=le(b);if(N&&(G(R,b),b.pendingcb===0&&(b.finished=!0,R.emit("finish"),b.autoDestroy))){var j=R._readableState;(!j||j.autoDestroy&&j.endEmitted)&&R.destroy()}return N}function ke(R,b,N){b.ending=!0,_e(R,b),N&&(b.finished?process.nextTick(N):R.once("finish",N)),b.ended=!0,R.writable=!1}function Ye(R,b,N){var j=R.entry;for(R.entry=null;j;){var V=j.callback;b.pendingcb--,V(N),j=j.next}b.corkedRequestsFree.next=R}return Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(b){this._writableState&&(this._writableState.destroyed=b)}}),H.prototype.destroy=p.destroy,H.prototype._undestroy=p.undestroy,H.prototype._destroy=function(R,b){b(R)},qt}var jt,kr;function et(){if(kr)return jt;kr=1;var r=Object.keys||function(g){var y=[];for(var w in g)y.push(w);return y};jt=c;var e=yn(),t=pn();gt(c,e);for(var n=r(t.prototype),o=0;o<n.length;o++){var a=n[o];c.prototype[a]||(c.prototype[a]=t.prototype[a])}function c(g){if(!(this instanceof c))return new c(g);e.call(this,g),t.call(this,g),this.allowHalfOpen=!0,g&&(g.readable===!1&&(this.readable=!1),g.writable===!1&&(this.writable=!1),g.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",l)))}Object.defineProperty(c.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(c.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(c.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function l(){this._writableState.ended||process.nextTick(p,this)}function p(g){g.end()}return Object.defineProperty(c.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(y){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=y,this._writableState.destroyed=y)}}),jt}var Wt={},Nr;function Or(){if(Nr)return Wt;Nr=1;var r=ln.Buffer,e=r.isEncoding||function(_){switch(_=""+_,_&&_.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function t(_){if(!_)return"utf8";for(var T;;)switch(_){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return _;default:if(T)return;_=(""+_).toLowerCase(),T=!0}}function n(_){var T=t(_);if(typeof T!="string"&&(r.isEncoding===e||!e(_)))throw new Error("Unknown encoding: "+_);return T||_}Wt.StringDecoder=o;function o(_){this.encoding=n(_);var T;switch(this.encoding){case"utf16le":this.text=w,this.end=v,T=4;break;case"utf8":this.fillLast=p,T=4;break;case"base64":this.text=C,this.end=A,T=3;break;default:this.write=x,this.end=B;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(T)}o.prototype.write=function(_){if(_.length===0)return"";var T,O;if(this.lastNeed){if(T=this.fillLast(_),T===void 0)return"";O=this.lastNeed,this.lastNeed=0}else O=0;return O<_.length?T?T+this.text(_,O):this.text(_,O):T||""},o.prototype.end=y,o.prototype.text=g,o.prototype.fillLast=function(_){if(this.lastNeed<=_.length)return _.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,this.lastTotal-this.lastNeed,0,_.length),this.lastNeed-=_.length};function a(_){return _<=127?0:_>>5===6?2:_>>4===14?3:_>>3===30?4:_>>6===2?-1:-2}function c(_,T,O){var F=T.length-1;if(F<O)return 0;var L=a(T[F]);return L>=0?(L>0&&(_.lastNeed=L-1),L):--F<O||L===-2?0:(L=a(T[F]),L>=0?(L>0&&(_.lastNeed=L-2),L):--F<O||L===-2?0:(L=a(T[F]),L>=0?(L>0&&(L===2?L=0:_.lastNeed=L-3),L):0))}function l(_,T,O){if((T[0]&192)!==128)return _.lastNeed=0,"";if(_.lastNeed>1&&T.length>1){if((T[1]&192)!==128)return _.lastNeed=1,"";if(_.lastNeed>2&&T.length>2&&(T[2]&192)!==128)return _.lastNeed=2,""}}function p(_){var T=this.lastTotal-this.lastNeed,O=l(this,_);if(O!==void 0)return O;if(this.lastNeed<=_.length)return _.copy(this.lastChar,T,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);_.copy(this.lastChar,T,0,_.length),this.lastNeed-=_.length}function g(_,T){var O=c(this,_,T);if(!this.lastNeed)return _.toString("utf8",T);this.lastTotal=O;var F=_.length-(O-this.lastNeed);return _.copy(this.lastChar,0,F),_.toString("utf8",T,F)}function y(_){var T=_&&_.length?this.write(_):"";return this.lastNeed?T+"":T}function w(_,T){if((_.length-T)%2===0){var O=_.toString("utf16le",T);if(O){var F=O.charCodeAt(O.length-1);if(F>=55296&&F<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1],O.slice(0,-1)}return O}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=_[_.length-1],_.toString("utf16le",T,_.length-1)}function v(_){var T=_&&_.length?this.write(_):"";if(this.lastNeed){var O=this.lastTotal-this.lastNeed;return T+this.lastChar.toString("utf16le",0,O)}return T}function C(_,T){var O=(_.length-T)%3;return O===0?_.toString("base64",T):(this.lastNeed=3-O,this.lastTotal=3,O===1?this.lastChar[0]=_[_.length-1]:(this.lastChar[0]=_[_.length-2],this.lastChar[1]=_[_.length-1]),_.toString("base64",T,_.length-O))}function A(_){var T=_&&_.length?this.write(_):"";return this.lastNeed?T+this.lastChar.toString("base64",0,3-this.lastNeed):T}function x(_){return _.toString(this.encoding)}function B(_){return _&&_.length?this.write(_):""}return Wt}var Fr=Ve.codes.ERR_STREAM_PREMATURE_CLOSE;function Yi(r){var e=!1;return function(){if(!e){e=!0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];r.apply(this,n)}}}function Ki(){}function Gi(r){return r.setHeader&&typeof r.abort=="function"}function gn(r,e,t){if(typeof e=="function")return gn(r,null,e);e||(e={}),t=Yi(t||Ki);var n=e.readable||e.readable!==!1&&r.readable,o=e.writable||e.writable!==!1&&r.writable,a=function(){r.writable||l()},c=r._writableState&&r._writableState.finished,l=function(){o=!1,c=!0,n||t.call(r)},p=r._readableState&&r._readableState.endEmitted,g=function(){n=!1,p=!0,o||t.call(r)},y=function(A){t.call(r,A)},w=function(){var A;if(n&&!p)return(!r._readableState||!r._readableState.ended)&&(A=new Fr),t.call(r,A);if(o&&!c)return(!r._writableState||!r._writableState.ended)&&(A=new Fr),t.call(r,A)},v=function(){r.req.on("finish",l)};return Gi(r)?(r.on("complete",l),r.on("abort",w),r.req?v():r.on("request",v)):o&&!r._writableState&&(r.on("end",a),r.on("close",a)),r.on("end",g),r.on("finish",l),e.error!==!1&&r.on("error",y),r.on("close",w),function(){r.removeListener("complete",l),r.removeListener("abort",w),r.removeListener("request",v),r.req&&r.req.removeListener("finish",l),r.removeListener("end",a),r.removeListener("close",a),r.removeListener("finish",l),r.removeListener("end",g),r.removeListener("error",y),r.removeListener("close",w)}}var gr=gn,Ht,Ir;function Ji(){if(Ir)return Ht;Ir=1;var r;function e(O,F,L){return F=t(F),F in O?Object.defineProperty(O,F,{value:L,enumerable:!0,configurable:!0,writable:!0}):O[F]=L,O}function t(O){var F=n(O,"string");return typeof F=="symbol"?F:String(F)}function n(O,F){if(typeof O!="object"||O===null)return O;var L=O[Symbol.toPrimitive];if(L!==void 0){var q=L.call(O,F);if(typeof q!="object")return q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)(O)}var o=gr,a=Symbol("lastResolve"),c=Symbol("lastReject"),l=Symbol("error"),p=Symbol("ended"),g=Symbol("lastPromise"),y=Symbol("handlePromise"),w=Symbol("stream");function v(O,F){return{value:O,done:F}}function C(O){var F=O[a];if(F!==null){var L=O[w].read();L!==null&&(O[g]=null,O[a]=null,O[c]=null,F(v(L,!1)))}}function A(O){process.nextTick(C,O)}function x(O,F){return function(L,q){O.then(function(){if(F[p]){L(v(void 0,!0));return}F[y](L,q)},q)}}var B=Object.getPrototypeOf(function(){}),_=Object.setPrototypeOf((r={get stream(){return this[w]},next:function(){var F=this,L=this[l];if(L!==null)return Promise.reject(L);if(this[p])return Promise.resolve(v(void 0,!0));if(this[w].destroyed)return new Promise(function(P,pe){process.nextTick(function(){F[l]?pe(F[l]):P(v(void 0,!0))})});var q=this[g],X;if(q)X=new Promise(x(q,this));else{var H=this[w].read();if(H!==null)return Promise.resolve(v(H,!1));X=new Promise(this[y])}return this[g]=X,X}},e(r,Symbol.asyncIterator,function(){return this}),e(r,"return",function(){var F=this;return new Promise(function(L,q){F[w].destroy(null,function(X){if(X){q(X);return}L(v(void 0,!0))})})}),r),B),T=function(F){var L,q=Object.create(_,(L={},e(L,w,{value:F,writable:!0}),e(L,a,{value:null,writable:!0}),e(L,c,{value:null,writable:!0}),e(L,l,{value:null,writable:!0}),e(L,p,{value:F._readableState.endEmitted,writable:!0}),e(L,y,{value:function(H,P){var pe=q[w].read();pe?(q[g]=null,q[a]=null,q[c]=null,H(v(pe,!1))):(q[a]=H,q[c]=P)},writable:!0}),L));return q[g]=null,o(F,function(X){if(X&&X.code!=="ERR_STREAM_PREMATURE_CLOSE"){var H=q[c];H!==null&&(q[g]=null,q[a]=null,q[c]=null,H(X)),q[l]=X;return}var P=q[a];P!==null&&(q[g]=null,q[a]=null,q[c]=null,P(v(void 0,!0))),q[p]=!0}),F.on("readable",A.bind(null,q)),q};return Ht=T,Ht}var Vt,Lr;function zi(){return Lr||(Lr=1,Vt=function(){throw new Error("Readable.from is not available in the browser")}),Vt}var Yt,Pr;function yn(){if(Pr)return Yt;Pr=1,Yt=P;var r;P.ReadableState=H,Tt.EventEmitter;var e=function(d,k){return d.listeners(k).length},t=cn,n=st.Buffer,o=(typeof Pe<"u"?Pe:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(h){return n.from(h)}function c(h){return n.isBuffer(h)||h instanceof o}var l=Tt,p;l&&l.debuglog?p=l.debuglog("stream"):p=function(){};var g=Oi(),y=fn,w=dn,v=w.getHighWaterMark,C=Ve.codes,A=C.ERR_INVALID_ARG_TYPE,x=C.ERR_STREAM_PUSH_AFTER_EOF,B=C.ERR_METHOD_NOT_IMPLEMENTED,_=C.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,T,O,F;gt(P,t);var L=y.errorOrDestroy,q=["error","close","destroy","pause","resume"];function X(h,d,k){if(typeof h.prependListener=="function")return h.prependListener(d,k);!h._events||!h._events[d]?h.on(d,k):Array.isArray(h._events[d])?h._events[d].unshift(k):h._events[d]=[k,h._events[d]]}function H(h,d,k){r=r||et(),h=h||{},typeof k!="boolean"&&(k=d instanceof r),this.objectMode=!!h.objectMode,k&&(this.objectMode=this.objectMode||!!h.readableObjectMode),this.highWaterMark=v(this,h,"readableHighWaterMark",k),this.buffer=new g,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=h.emitClose!==!1,this.autoDestroy=!!h.autoDestroy,this.destroyed=!1,this.defaultEncoding=h.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,h.encoding&&(T||(T=Or().StringDecoder),this.decoder=new T(h.encoding),this.encoding=h.encoding)}function P(h){if(r=r||et(),!(this instanceof P))return new P(h);var d=this instanceof r;this._readableState=new H(h,this,d),this.readable=!0,h&&(typeof h.read=="function"&&(this._read=h.read),typeof h.destroy=="function"&&(this._destroy=h.destroy)),t.call(this)}Object.defineProperty(P.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(d){this._readableState&&(this._readableState.destroyed=d)}}),P.prototype.destroy=y.destroy,P.prototype._undestroy=y.undestroy,P.prototype._destroy=function(h,d){d(h)},P.prototype.push=function(h,d){var k=this._readableState,D;return k.objectMode?D=!0:typeof h=="string"&&(d=d||k.defaultEncoding,d!==k.encoding&&(h=n.from(h,d),d=""),D=!0),pe(this,h,d,!1,D)},P.prototype.unshift=function(h){return pe(this,h,null,!0,!1)};function pe(h,d,k,D,ne){p("readableAddChunk",d);var Y=h._readableState;if(d===null)Y.reading=!1,re(h,Y);else{var Q;if(ne||(Q=be(Y,d)),Q)L(h,Q);else if(Y.objectMode||d&&d.length>0)if(typeof d!="string"&&!Y.objectMode&&Object.getPrototypeOf(d)!==n.prototype&&(d=a(d)),D)Y.endEmitted?L(h,new _):he(h,Y,d,!0);else if(Y.ended)L(h,new x);else{if(Y.destroyed)return!1;Y.reading=!1,Y.decoder&&!k?(d=Y.decoder.write(d),Y.objectMode||d.length!==0?he(h,Y,d,!1):se(h,Y)):he(h,Y,d,!1)}else D||(Y.reading=!1,se(h,Y))}return!Y.ended&&(Y.length<Y.highWaterMark||Y.length===0)}function he(h,d,k,D){d.flowing&&d.length===0&&!d.sync?(d.awaitDrain=0,h.emit("data",k)):(d.length+=d.objectMode?1:k.length,D?d.buffer.unshift(k):d.buffer.push(k),d.needReadable&&Z(h)),se(h,d)}function be(h,d){var k;return!c(d)&&typeof d!="string"&&d!==void 0&&!h.objectMode&&(k=new A("chunk",["string","Buffer","Uint8Array"],d)),k}P.prototype.isPaused=function(){return this._readableState.flowing===!1},P.prototype.setEncoding=function(h){T||(T=Or().StringDecoder);var d=new T(h);this._readableState.decoder=d,this._readableState.encoding=this._readableState.decoder.encoding;for(var k=this._readableState.buffer.head,D="";k!==null;)D+=d.write(k.data),k=k.next;return this._readableState.buffer.clear(),D!==""&&this._readableState.buffer.push(D),this._readableState.length=D.length,this};var Ee=1073741824;function Ie(h){return h>=Ee?h=Ee:(h--,h|=h>>>1,h|=h>>>2,h|=h>>>4,h|=h>>>8,h|=h>>>16,h++),h}function oe(h,d){return h<=0||d.length===0&&d.ended?0:d.objectMode?1:h!==h?d.flowing&&d.length?d.buffer.head.data.length:d.length:(h>d.highWaterMark&&(d.highWaterMark=Ie(h)),h<=d.length?h:d.ended?d.length:(d.needReadable=!0,0))}P.prototype.read=function(h){p("read",h),h=parseInt(h,10);var d=this._readableState,k=h;if(h!==0&&(d.emittedReadable=!1),h===0&&d.needReadable&&((d.highWaterMark!==0?d.length>=d.highWaterMark:d.length>0)||d.ended))return p("read: emitReadable",d.length,d.ended),d.length===0&&d.ended?N(this):Z(this),null;if(h=oe(h,d),h===0&&d.ended)return d.length===0&&N(this),null;var D=d.needReadable;p("need readable",D),(d.length===0||d.length-h<d.highWaterMark)&&(D=!0,p("length less than watermark",D)),d.ended||d.reading?(D=!1,p("reading or ended",D)):D&&(p("do read"),d.reading=!0,d.sync=!0,d.length===0&&(d.needReadable=!0),this._read(d.highWaterMark),d.sync=!1,d.reading||(h=oe(k,d)));var ne;return h>0?ne=b(h,d):ne=null,ne===null?(d.needReadable=d.length<=d.highWaterMark,h=0):(d.length-=h,d.awaitDrain=0),d.length===0&&(d.ended||(d.needReadable=!0),k!==h&&d.ended&&N(this)),ne!==null&&this.emit("data",ne),ne};function re(h,d){if(p("onEofChunk"),!d.ended){if(d.decoder){var k=d.decoder.end();k&&k.length&&(d.buffer.push(k),d.length+=d.objectMode?1:k.length)}d.ended=!0,d.sync?Z(h):(d.needReadable=!1,d.emittedReadable||(d.emittedReadable=!0,te(h)))}}function Z(h){var d=h._readableState;p("emitReadable",d.needReadable,d.emittedReadable),d.needReadable=!1,d.emittedReadable||(p("emitReadable",d.flowing),d.emittedReadable=!0,process.nextTick(te,h))}function te(h){var d=h._readableState;p("emitReadable_",d.destroyed,d.length,d.ended),!d.destroyed&&(d.length||d.ended)&&(h.emit("readable"),d.emittedReadable=!1),d.needReadable=!d.flowing&&!d.ended&&d.length<=d.highWaterMark,R(h)}function se(h,d){d.readingMore||(d.readingMore=!0,process.nextTick(le,h,d))}function le(h,d){for(;!d.reading&&!d.ended&&(d.length<d.highWaterMark||d.flowing&&d.length===0);){var k=d.length;if(p("maybeReadMore read 0"),h.read(0),k===d.length)break}d.readingMore=!1}P.prototype._read=function(h){L(this,new B("_read()"))},P.prototype.pipe=function(h,d){var k=this,D=this._readableState;switch(D.pipesCount){case 0:D.pipes=h;break;case 1:D.pipes=[D.pipes,h];break;default:D.pipes.push(h);break}D.pipesCount+=1,p("pipe count=%d opts=%j",D.pipesCount,d);var ne=(!d||d.end!==!1)&&h!==process.stdout&&h!==process.stderr,Y=ne?Me:je;D.endEmitted?process.nextTick(Y):k.once("end",Y),h.on("unpipe",Q);function Q(u,i){p("onunpipe"),u===k&&i&&i.hasUnpiped===!1&&(i.hasUnpiped=!0,Ge())}function Me(){p("onend"),h.end()}var Ke=M(k);h.on("drain",Ke);var at=!1;function Ge(){p("cleanup"),h.removeListener("close",ut),h.removeListener("finish",Re),h.removeListener("drain",Ke),h.removeListener("error",qe),h.removeListener("unpipe",Q),k.removeListener("end",Me),k.removeListener("end",je),k.removeListener("data",me),at=!0,D.awaitDrain&&(!h._writableState||h._writableState.needDrain)&&Ke()}k.on("data",me);function me(u){p("ondata");var i=h.write(u);p("dest.write",i),i===!1&&((D.pipesCount===1&&D.pipes===h||D.pipesCount>1&&V(D.pipes,h)!==-1)&&!at&&(p("false write response, pause",D.awaitDrain),D.awaitDrain++),k.pause())}function qe(u){p("onerror",u),je(),h.removeListener("error",qe),e(h,"error")===0&&L(h,u)}X(h,"error",qe);function ut(){h.removeListener("finish",Re),je()}h.once("close",ut);function Re(){p("onfinish"),h.removeListener("close",ut),je()}h.once("finish",Re);function je(){p("unpipe"),k.unpipe(h)}return h.emit("pipe",k),D.flowing||(p("pipe resume"),k.resume()),h};function M(h){return function(){var k=h._readableState;p("pipeOnDrain",k.awaitDrain),k.awaitDrain&&k.awaitDrain--,k.awaitDrain===0&&e(h,"data")&&(k.flowing=!0,R(h))}}P.prototype.unpipe=function(h){var d=this._readableState,k={hasUnpiped:!1};if(d.pipesCount===0)return this;if(d.pipesCount===1)return h&&h!==d.pipes?this:(h||(h=d.pipes),d.pipes=null,d.pipesCount=0,d.flowing=!1,h&&h.emit("unpipe",this,k),this);if(!h){var D=d.pipes,ne=d.pipesCount;d.pipes=null,d.pipesCount=0,d.flowing=!1;for(var Y=0;Y<ne;Y++)D[Y].emit("unpipe",this,{hasUnpiped:!1});return this}var Q=V(d.pipes,h);return Q===-1?this:(d.pipes.splice(Q,1),d.pipesCount-=1,d.pipesCount===1&&(d.pipes=d.pipes[0]),h.emit("unpipe",this,k),this)},P.prototype.on=function(h,d){var k=t.prototype.on.call(this,h,d),D=this._readableState;return h==="data"?(D.readableListening=this.listenerCount("readable")>0,D.flowing!==!1&&this.resume()):h==="readable"&&!D.endEmitted&&!D.readableListening&&(D.readableListening=D.needReadable=!0,D.flowing=!1,D.emittedReadable=!1,p("on readable",D.length,D.reading),D.length?Z(this):D.reading||process.nextTick(_e,this)),k},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(h,d){var k=t.prototype.removeListener.call(this,h,d);return h==="readable"&&process.nextTick(G,this),k},P.prototype.removeAllListeners=function(h){var d=t.prototype.removeAllListeners.apply(this,arguments);return(h==="readable"||h===void 0)&&process.nextTick(G,this),d};function G(h){var d=h._readableState;d.readableListening=h.listenerCount("readable")>0,d.resumeScheduled&&!d.paused?d.flowing=!0:h.listenerCount("data")>0&&h.resume()}function _e(h){p("readable nexttick read 0"),h.read(0)}P.prototype.resume=function(){var h=this._readableState;return h.flowing||(p("resume"),h.flowing=!h.readableListening,ke(this,h)),h.paused=!1,this};function ke(h,d){d.resumeScheduled||(d.resumeScheduled=!0,process.nextTick(Ye,h,d))}function Ye(h,d){p("resume",d.reading),d.reading||h.read(0),d.resumeScheduled=!1,h.emit("resume"),R(h),d.flowing&&!d.reading&&h.read(0)}P.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function R(h){var d=h._readableState;for(p("flow",d.flowing);d.flowing&&h.read()!==null;);}P.prototype.wrap=function(h){var d=this,k=this._readableState,D=!1;h.on("end",function(){if(p("wrapped end"),k.decoder&&!k.ended){var Q=k.decoder.end();Q&&Q.length&&d.push(Q)}d.push(null)}),h.on("data",function(Q){if(p("wrapped data"),k.decoder&&(Q=k.decoder.write(Q)),!(k.objectMode&&Q==null)&&!(!k.objectMode&&(!Q||!Q.length))){var Me=d.push(Q);Me||(D=!0,h.pause())}});for(var ne in h)this[ne]===void 0&&typeof h[ne]=="function"&&(this[ne]=function(Me){return function(){return h[Me].apply(h,arguments)}}(ne));for(var Y=0;Y<q.length;Y++)h.on(q[Y],this.emit.bind(this,q[Y]));return this._read=function(Q){p("wrapped _read",Q),D&&(D=!1,h.resume())},this},typeof Symbol=="function"&&(P.prototype[Symbol.asyncIterator]=function(){return O===void 0&&(O=Ji()),O(this)}),Object.defineProperty(P.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(P.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(P.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(d){this._readableState&&(this._readableState.flowing=d)}}),P._fromList=b,Object.defineProperty(P.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function b(h,d){if(d.length===0)return null;var k;return d.objectMode?k=d.buffer.shift():!h||h>=d.length?(d.decoder?k=d.buffer.join(""):d.buffer.length===1?k=d.buffer.first():k=d.buffer.concat(d.length),d.buffer.clear()):k=d.buffer.consume(h,d.decoder),k}function N(h){var d=h._readableState;p("endReadable",d.endEmitted),d.endEmitted||(d.ended=!0,process.nextTick(j,d,h))}function j(h,d){if(p("endReadableNT",h.endEmitted,h.length),!h.endEmitted&&h.length===0&&(h.endEmitted=!0,d.readable=!1,d.emit("end"),h.autoDestroy)){var k=d._writableState;(!k||k.autoDestroy&&k.finished)&&d.destroy()}}typeof Symbol=="function"&&(P.from=function(h,d){return F===void 0&&(F=zi()),F(P,h,d)});function V(h,d){for(var k=0,D=h.length;k<D;k++)if(h[k]===d)return k;return-1}return Yt}var _n=De,xt=Ve.codes,Xi=xt.ERR_METHOD_NOT_IMPLEMENTED,Qi=xt.ERR_MULTIPLE_CALLBACK,Zi=xt.ERR_TRANSFORM_ALREADY_TRANSFORMING,$i=xt.ERR_TRANSFORM_WITH_LENGTH_0,Bt=et();gt(De,Bt);function es(r,e){var t=this._transformState;t.transforming=!1;var n=t.writecb;if(n===null)return this.emit("error",new Qi);t.writechunk=null,t.writecb=null,e!=null&&this.push(e),n(r);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function De(r){if(!(this instanceof De))return new De(r);Bt.call(this,r),this._transformState={afterTransform:es.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",ts)}function ts(){var r=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,t){Dr(r,e,t)}):Dr(this,null,null)}De.prototype.push=function(r,e){return this._transformState.needTransform=!1,Bt.prototype.push.call(this,r,e)};De.prototype._transform=function(r,e,t){t(new Xi("_transform()"))};De.prototype._write=function(r,e,t){var n=this._transformState;if(n.writecb=t,n.writechunk=r,n.writeencoding=e,!n.transforming){var o=this._readableState;(n.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}};De.prototype._read=function(r){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};De.prototype._destroy=function(r,e){Bt.prototype._destroy.call(this,r,function(t){e(t)})};function Dr(r,e,t){if(e)return r.emit("error",e);if(t!=null&&r.push(t),r._writableState.length)throw new $i;if(r._transformState.transforming)throw new Zi;return r.push(null)}var rs=pt,mn=_n;gt(pt,mn);function pt(r){if(!(this instanceof pt))return new pt(r);mn.call(this,r)}pt.prototype._transform=function(r,e,t){t(null,r)};var Kt;function ns(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var wn=Ve.codes,is=wn.ERR_MISSING_ARGS,ss=wn.ERR_STREAM_DESTROYED;function Mr(r){if(r)throw r}function os(r){return r.setHeader&&typeof r.abort=="function"}function as(r,e,t,n){n=ns(n);var o=!1;r.on("close",function(){o=!0}),Kt===void 0&&(Kt=gr),Kt(r,{readable:e,writable:t},function(c){if(c)return n(c);o=!0,n()});var a=!1;return function(c){if(!o&&!a){if(a=!0,os(r))return r.abort();if(typeof r.destroy=="function")return r.destroy();n(c||new ss("pipe"))}}}function Ur(r){r()}function us(r,e){return r.pipe(e)}function ls(r){return!r.length||typeof r[r.length-1]!="function"?Mr:r.pop()}function cs(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var n=ls(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new is("streams");var o,a=e.map(function(c,l){var p=l<e.length-1,g=l>0;return as(c,p,g,function(y){o||(o=y),y&&a.forEach(Ur),!p&&(a.forEach(Ur),n(o))})});return e.reduce(us)}var fs=cs;(function(r,e){e=r.exports=yn(),e.Stream=e,e.Readable=e,e.Writable=pn(),e.Duplex=et(),e.Transform=_n,e.PassThrough=rs,e.finished=gr,e.pipeline=fs})(sr,sr.exports);var hs=sr.exports;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let qr;var ds=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:Pe):r=>(qr||(qr=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0));function jr(r,e){for(const t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function ps(r,e,t){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");t||(t={}),typeof e=="object"&&(t=e,e=""),e&&(t.code=e);try{return jr(r,t)}catch{t.message=r.message,t.stack=r.stack;const o=function(){};return o.prototype=Object.create(Object.getPrototypeOf(r)),jr(new o,t)}}var gs=ps;/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const ys=gi("simple-peer"),bn=yi,Wr=Bi,_s=hs,Gt=ds,J=gs,{Buffer:ms}=st,Jt=64*1024,ws=5*1e3,bs=5*1e3;function Hr(r){return r.replace(/a=ice-options:trickle\s\n/g,"")}function Es(r){console.warn(r)}class He extends _s.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=Wr(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Wr(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||He.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},He.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(t=>t),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||ws,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:bn(),!this._wrtc)throw J(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){this.destroy(J(t,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=t=>{this._onIceCandidate(t)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(t=>{this.destroy(J(t,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=t=>{this._setupData(t)},this.streams&&this.streams.forEach(t=>{this.addStream(t)}),this._pc.ontrack=t=>{this._onTrack(t)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw J(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(t=>{this._addIceCandidate(t)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(t=>{this.destroy(J(t,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(J(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(n=>{!t.address||t.address.endsWith(".local")?Es("Ignoring unsupported ICE candidate."):this.destroy(J(n,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw J(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,t){if(!this.destroying){if(this.destroyed)throw J(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(n){this.destroy(J(n,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw J(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}}addTrack(e,t){if(this.destroying)return;if(this.destroyed)throw J(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const n=this._senderMap.get(e)||new Map;let o=n.get(t);if(!o)o=this._pc.addTrack(e,t),n.set(t,o),this._senderMap.set(e,n),this._needsNegotiation();else throw o.removed?J(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):J(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,t,n){if(this.destroying)return;if(this.destroyed)throw J(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const o=this._senderMap.get(e),a=o?o.get(n):null;if(!a)throw J(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,o),a.replaceTrack!=null?a.replaceTrack(t):this.destroy(J(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){if(this.destroying)return;if(this.destroyed)throw J(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const n=this._senderMap.get(e),o=n?n.get(t):null;if(!o)throw J(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{o.removed=!0,this._pc.removeTrack(o)}catch(a){a.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(o):this.destroy(J(a,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw J(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,Gt(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw J(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),Gt(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}))}_setupData(e){if(!e.channel)return this.destroy(J(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=Jt),this.channelName=this._channel.label,this._channel.onmessage=n=>{this._onChannelMessage(n)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=n=>{const o=n.error instanceof Error?n.error:new Error(`Datachannel error: ${n.message} ${n.filename}:${n.lineno}:${n.colno}`);this.destroy(J(o,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(t&&this._onChannelClose(),t=!0):t=!1},bs)}_read(){}_write(e,t,n){if(this.destroyed)return n(J(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(o){return this.destroy(J(o,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>Jt?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Hr(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const a=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:a.type,sdp:a.sdp})},n=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},o=a=>{this.destroy(J(a,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(n).catch(o)}).catch(e=>{this.destroy(J(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Hr(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const a=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:a.type,sdp:a.sdp}),this.initiator||this._requestMissingTransceivers()},n=()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))},o=a=>{this.destroy(J(a,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(n).catch(o)}).catch(e=>{this.destroy(J(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(J(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(J(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(J(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=n=>(Object.prototype.toString.call(n.values)==="[object Array]"&&n.values.forEach(o=>{Object.assign(n,o)}),n);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(n=>{const o=[];n.forEach(a=>{o.push(t(a))}),e(null,o)},n=>e(n)):this._pc.getStats.length>0?this._pc.getStats(n=>{if(this.destroyed)return;const o=[];n.result().forEach(a=>{const c={};a.names().forEach(l=>{c[l]=a.stat(l)}),c.id=a.id,c.type=a.type,c.timestamp=a.timestamp,o.push(t(c))}),e(null,o)},n=>e(n)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((t,n)=>{if(this.destroyed)return;t&&(n=[]);const o={},a={},c={};let l=!1;n.forEach(g=>{(g.type==="remotecandidate"||g.type==="remote-candidate")&&(o[g.id]=g),(g.type==="localcandidate"||g.type==="local-candidate")&&(a[g.id]=g),(g.type==="candidatepair"||g.type==="candidate-pair")&&(c[g.id]=g)});const p=g=>{l=!0;let y=a[g.localCandidateId];y&&(y.ip||y.address)?(this.localAddress=y.ip||y.address,this.localPort=Number(y.port)):y&&y.ipAddress?(this.localAddress=y.ipAddress,this.localPort=Number(y.portNumber)):typeof g.googLocalAddress=="string"&&(y=g.googLocalAddress.split(":"),this.localAddress=y[0],this.localPort=Number(y[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let w=o[g.remoteCandidateId];w&&(w.ip||w.address)?(this.remoteAddress=w.ip||w.address,this.remotePort=Number(w.port)):w&&w.ipAddress?(this.remoteAddress=w.ipAddress,this.remotePort=Number(w.portNumber)):typeof g.googRemoteAddress=="string"&&(w=g.googRemoteAddress.split(":"),this.remoteAddress=w[0],this.remotePort=Number(w[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(n.forEach(g=>{g.type==="transport"&&g.selectedCandidatePairId&&p(c[g.selectedCandidatePairId]),(g.type==="googCandidatePair"&&g.googActiveConnection==="true"||(g.type==="candidatepair"||g.type==="candidate-pair")&&g.selected)&&p(g)}),!l&&(!Object.keys(c).length||Object.keys(a).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(y){return this.destroy(J(y,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const g=this._cb;this._cb=null,g(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>Jt||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=ms.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),!this._remoteStreams.some(n=>n.id===t.id)&&(this._remoteStreams.push(t),Gt(()=>{this._debug("on stream"),this.emit("stream",t)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],ys.apply(null,e)}}He.WEBRTC_SUPPORT=!!bn();He.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};He.channelConfig={};var Rs=He;const vs=ci(Rs),Cs=[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"}],St=16*1024;function Ts(r,e=St){const t=[];for(let n=0;n<r.length;n+=e)t.push(r.slice(n,n+e));return t}async function*Ss(r,e=St){let t=0;for(;t<r.size;){const o=await r.slice(t,t+e).arrayBuffer();yield new Uint8Array(o),t+=e}}const Fe=Object.create(null);Fe.open="0";Fe.close="1";Fe.ping="2";Fe.pong="3";Fe.message="4";Fe.upgrade="5";Fe.noop="6";const bt=Object.create(null);Object.keys(Fe).forEach(r=>{bt[Fe[r]]=r});const ur={type:"error",data:"parser error"},En=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Rn=typeof ArrayBuffer=="function",vn=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer,yr=({type:r,data:e},t,n)=>En&&e instanceof Blob?t?n(e):Vr(e,n):Rn&&(e instanceof ArrayBuffer||vn(e))?t?n(e):Vr(new Blob([e]),n):n(Fe[r]+(e||"")),Vr=(r,e)=>{const t=new FileReader;return t.onload=function(){const n=t.result.split(",")[1];e("b"+(n||""))},t.readAsDataURL(r)};function Yr(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength)}let zt;function As(r,e){if(En&&r.data instanceof Blob)return r.data.arrayBuffer().then(Yr).then(e);if(Rn&&(r.data instanceof ArrayBuffer||vn(r.data)))return e(Yr(r.data));yr(r,!1,t=>{zt||(zt=new TextEncoder),e(zt.encode(t))})}const Kr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ct=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let r=0;r<Kr.length;r++)ct[Kr.charCodeAt(r)]=r;const xs=r=>{let e=r.length*.75,t=r.length,n,o=0,a,c,l,p;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);const g=new ArrayBuffer(e),y=new Uint8Array(g);for(n=0;n<t;n+=4)a=ct[r.charCodeAt(n)],c=ct[r.charCodeAt(n+1)],l=ct[r.charCodeAt(n+2)],p=ct[r.charCodeAt(n+3)],y[o++]=a<<2|c>>4,y[o++]=(c&15)<<4|l>>2,y[o++]=(l&3)<<6|p&63;return g},Bs=typeof ArrayBuffer=="function",_r=(r,e)=>{if(typeof r!="string")return{type:"message",data:Cn(r,e)};const t=r.charAt(0);return t==="b"?{type:"message",data:ks(r.substring(1),e)}:bt[t]?r.length>1?{type:bt[t],data:r.substring(1)}:{type:bt[t]}:ur},ks=(r,e)=>{if(Bs){const t=xs(r);return Cn(t,e)}else return{base64:!0,data:r}},Cn=(r,e)=>{switch(e){case"blob":return r instanceof Blob?r:new Blob([r]);case"arraybuffer":default:return r instanceof ArrayBuffer?r:r.buffer}},Tn="",Ns=(r,e)=>{const t=r.length,n=new Array(t);let o=0;r.forEach((a,c)=>{yr(a,!1,l=>{n[c]=l,++o===t&&e(n.join(Tn))})})},Os=(r,e)=>{const t=r.split(Tn),n=[];for(let o=0;o<t.length;o++){const a=_r(t[o],e);if(n.push(a),a.type==="error")break}return n};function Fs(){return new TransformStream({transform(r,e){As(r,t=>{const n=t.length;let o;if(n<126)o=new Uint8Array(1),new DataView(o.buffer).setUint8(0,n);else if(n<65536){o=new Uint8Array(3);const a=new DataView(o.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{o=new Uint8Array(9);const a=new DataView(o.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}r.data&&typeof r.data!="string"&&(o[0]|=128),e.enqueue(o),e.enqueue(t)})}})}let Xt;function yt(r){return r.reduce((e,t)=>e+t.length,0)}function _t(r,e){if(r[0].length===e)return r.shift();const t=new Uint8Array(e);let n=0;for(let o=0;o<e;o++)t[o]=r[0][n++],n===r[0].length&&(r.shift(),n=0);return r.length&&n<r[0].length&&(r[0]=r[0].slice(n)),t}function Is(r,e){Xt||(Xt=new TextDecoder);const t=[];let n=0,o=-1,a=!1;return new TransformStream({transform(c,l){for(t.push(c);;){if(n===0){if(yt(t)<1)break;const p=_t(t,1);a=(p[0]&128)===128,o=p[0]&127,o<126?n=3:o===126?n=1:n=2}else if(n===1){if(yt(t)<2)break;const p=_t(t,2);o=new DataView(p.buffer,p.byteOffset,p.length).getUint16(0),n=3}else if(n===2){if(yt(t)<8)break;const p=_t(t,8),g=new DataView(p.buffer,p.byteOffset,p.length),y=g.getUint32(0);if(y>Math.pow(2,21)-1){l.enqueue(ur);break}o=y*Math.pow(2,32)+g.getUint32(4),n=3}else{if(yt(t)<o)break;const p=_t(t,o);l.enqueue(_r(a?p:Xt.decode(p),e)),n=0}if(o===0||o>r){l.enqueue(ur);break}}}})}const Sn=4;function ce(r){if(r)return Ls(r)}function Ls(r){for(var e in ce.prototype)r[e]=ce.prototype[e];return r}ce.prototype.on=ce.prototype.addEventListener=function(r,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+r]=this._callbacks["$"+r]||[]).push(e),this};ce.prototype.once=function(r,e){function t(){this.off(r,t),e.apply(this,arguments)}return t.fn=e,this.on(r,t),this};ce.prototype.off=ce.prototype.removeListener=ce.prototype.removeAllListeners=ce.prototype.removeEventListener=function(r,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var t=this._callbacks["$"+r];if(!t)return this;if(arguments.length==1)return delete this._callbacks["$"+r],this;for(var n,o=0;o<t.length;o++)if(n=t[o],n===e||n.fn===e){t.splice(o,1);break}return t.length===0&&delete this._callbacks["$"+r],this};ce.prototype.emit=function(r){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),t=this._callbacks["$"+r],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t){t=t.slice(0);for(var n=0,o=t.length;n<o;++n)t[n].apply(this,e)}return this};ce.prototype.emitReserved=ce.prototype.emit;ce.prototype.listeners=function(r){return this._callbacks=this._callbacks||{},this._callbacks["$"+r]||[]};ce.prototype.hasListeners=function(r){return!!this.listeners(r).length};const kt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,t)=>t(e,0),Te=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Ps="arraybuffer";function An(r,...e){return e.reduce((t,n)=>(r.hasOwnProperty(n)&&(t[n]=r[n]),t),{})}const Ds=Te.setTimeout,Ms=Te.clearTimeout;function Nt(r,e){e.useNativeTimers?(r.setTimeoutFn=Ds.bind(Te),r.clearTimeoutFn=Ms.bind(Te)):(r.setTimeoutFn=Te.setTimeout.bind(Te),r.clearTimeoutFn=Te.clearTimeout.bind(Te))}const Us=1.33;function qs(r){return typeof r=="string"?js(r):Math.ceil((r.byteLength||r.size)*Us)}function js(r){let e=0,t=0;for(let n=0,o=r.length;n<o;n++)e=r.charCodeAt(n),e<128?t+=1:e<2048?t+=2:e<55296||e>=57344?t+=3:(n++,t+=4);return t}function xn(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ws(r){let e="";for(let t in r)r.hasOwnProperty(t)&&(e.length&&(e+="&"),e+=encodeURIComponent(t)+"="+encodeURIComponent(r[t]));return e}function Hs(r){let e={},t=r.split("&");for(let n=0,o=t.length;n<o;n++){let a=t[n].split("=");e[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return e}class Vs extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class mr extends ce{constructor(e){super(),this.writable=!1,Nt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new Vs(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=_r(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,t={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const t=Ws(e);return t.length?"?"+t:""}}class Ys extends mr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||t()})),this.writable||(n++,this.once("drain",function(){--n||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const t=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};Os(e,this.socket.binaryType).forEach(t),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Ns(e,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=xn()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.createUri(e,t)}}let Bn=!1;try{Bn=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Ks=Bn;function Gs(){}class Js extends Ys{constructor(e){if(super(e),typeof location<"u"){const t=location.protocol==="https:";let n=location.port;n||(n=t?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(o,a)=>{this.onError("xhr post error",o,a)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=e}}class Oe extends ce{constructor(e,t,n){super(),this.createRequest=e,Nt(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const t=An(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&n.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var o;n.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=Oe.requestsCount++,Oe.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Gs,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Oe.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Oe.requestsCount=0;Oe.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Gr);else if(typeof addEventListener=="function"){const r="onpagehide"in Te?"pagehide":"unload";addEventListener(r,Gr,!1)}}function Gr(){for(let r in Oe.requests)Oe.requests.hasOwnProperty(r)&&Oe.requests[r].abort()}const zs=function(){const r=kn({xdomain:!1});return r&&r.responseType!==null}();class Xs extends Js{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=zs&&!t}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new Oe(kn,this.uri(),e)}}function kn(r){const e=r.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Ks))return new XMLHttpRequest}catch{}if(!e)try{return new Te[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Nn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Qs extends mr{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=Nn?{}:An(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(o){return this.emitReserved("error",o)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],o=t===e.length-1;yr(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}o&&kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=xn()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Qt=Te.WebSocket||Te.MozWebSocket;class Zs extends Qs{createSocket(e,t,n){return Nn?new Qt(e,t,n):t?new Qt(e,t):new Qt(e)}doWrite(e,t){this.ws.send(t)}}class $s extends mr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=Is(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),o=Fs();o.readable.pipeTo(e.writable),this._writer=o.writable.getWriter();const a=()=>{n.read().then(({done:l,value:p})=>{l||(this.onPacket(p),a())}).catch(l=>{})};a();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],o=t===e.length-1;this._writer.write(n).then(()=>{o&&kt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const eo={websocket:Zs,webtransport:$s,polling:Xs},to=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ro=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function lr(r){if(r.length>8e3)throw"URI too long";const e=r,t=r.indexOf("["),n=r.indexOf("]");t!=-1&&n!=-1&&(r=r.substring(0,t)+r.substring(t,n).replace(/:/g,";")+r.substring(n,r.length));let o=to.exec(r||""),a={},c=14;for(;c--;)a[ro[c]]=o[c]||"";return t!=-1&&n!=-1&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=no(a,a.path),a.queryKey=io(a,a.query),a}function no(r,e){const t=/\/{2,9}/g,n=e.replace(t,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function io(r,e){const t={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,o,a){o&&(t[o]=a)}),t}const cr=typeof addEventListener=="function"&&typeof removeEventListener=="function",Et=[];cr&&addEventListener("offline",()=>{Et.forEach(r=>r())},!1);class Ue extends ce{constructor(e,t){if(super(),this.binaryType=Ps,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){const n=lr(e);t.hostname=n.host,t.secure=n.protocol==="https"||n.protocol==="wss",t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=lr(t.host).host);Nt(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(n=>{const o=n.prototype.name;this.transports.push(o),this._transportsByName[o]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Hs(this.opts.query)),cr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Et.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=Sn,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&Ue.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",Ue.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const o=this.writeBuffer[n].data;if(o&&(t+=qs(o)),n>0&&t>this._maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,kt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,o){if(typeof t=="function"&&(o=t,t=void 0),typeof n=="function"&&(o=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:e,data:t,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),o&&this.once("flush",o),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Ue.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),cr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Et.indexOf(this._offlineEventListener);n!==-1&&Et.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Ue.protocol=Sn;class so extends Ue{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Ue.priorWebsocketSuccess=!1;const o=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",w=>{if(!n)if(w.type==="pong"&&w.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Ue.priorWebsocketSuccess=t.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(y(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const v=new Error("probe error");v.transport=t.name,this.emitReserved("upgradeError",v)}}))};function a(){n||(n=!0,y(),t.close(),t=null)}const c=w=>{const v=new Error("probe error: "+w);v.transport=t.name,a(),this.emitReserved("upgradeError",v)};function l(){c("transport closed")}function p(){c("socket closed")}function g(w){t&&w.name!==t.name&&a()}const y=()=>{t.removeListener("open",o),t.removeListener("error",c),t.removeListener("close",l),this.off("close",p),this.off("upgrading",g)};t.once("open",o),t.once("error",c),t.once("close",l),this.once("close",p),this.once("upgrading",g),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}let oo=class extends so{constructor(e,t={}){const n=typeof e=="object"?e:t;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(o=>eo[o]).filter(o=>!!o)),super(e,n)}};function ao(r,e="",t){let n=r;t=t||typeof location<"u"&&location,r==null&&(r=t.protocol+"//"+t.host),typeof r=="string"&&(r.charAt(0)==="/"&&(r.charAt(1)==="/"?r=t.protocol+r:r=t.host+r),/^(https?|wss?):\/\//.test(r)||(typeof t<"u"?r=t.protocol+"//"+r:r="https://"+r),n=lr(r)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+e,n.href=n.protocol+"://"+a+(t&&t.port===n.port?"":":"+n.port),n}const uo=typeof ArrayBuffer=="function",lo=r=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r.buffer instanceof ArrayBuffer,On=Object.prototype.toString,co=typeof Blob=="function"||typeof Blob<"u"&&On.call(Blob)==="[object BlobConstructor]",fo=typeof File=="function"||typeof File<"u"&&On.call(File)==="[object FileConstructor]";function wr(r){return uo&&(r instanceof ArrayBuffer||lo(r))||co&&r instanceof Blob||fo&&r instanceof File}function Rt(r,e){if(!r||typeof r!="object")return!1;if(Array.isArray(r)){for(let t=0,n=r.length;t<n;t++)if(Rt(r[t]))return!0;return!1}if(wr(r))return!0;if(r.toJSON&&typeof r.toJSON=="function"&&arguments.length===1)return Rt(r.toJSON(),!0);for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&Rt(r[t]))return!0;return!1}function ho(r){const e=[],t=r.data,n=r;return n.data=fr(t,e),n.attachments=e.length,{packet:n,buffers:e}}function fr(r,e){if(!r)return r;if(wr(r)){const t={_placeholder:!0,num:e.length};return e.push(r),t}else if(Array.isArray(r)){const t=new Array(r.length);for(let n=0;n<r.length;n++)t[n]=fr(r[n],e);return t}else if(typeof r=="object"&&!(r instanceof Date)){const t={};for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=fr(r[n],e));return t}return r}function po(r,e){return r.data=hr(r.data,e),delete r.attachments,r}function hr(r,e){if(!r)return r;if(r&&r._placeholder===!0){if(typeof r.num=="number"&&r.num>=0&&r.num<e.length)return e[r.num];throw new Error("illegal attachments")}else if(Array.isArray(r))for(let t=0;t<r.length;t++)r[t]=hr(r[t],e);else if(typeof r=="object")for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&(r[t]=hr(r[t],e));return r}const go=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],yo=5;var z;(function(r){r[r.CONNECT=0]="CONNECT",r[r.DISCONNECT=1]="DISCONNECT",r[r.EVENT=2]="EVENT",r[r.ACK=3]="ACK",r[r.CONNECT_ERROR=4]="CONNECT_ERROR",r[r.BINARY_EVENT=5]="BINARY_EVENT",r[r.BINARY_ACK=6]="BINARY_ACK"})(z||(z={}));class _o{constructor(e){this.replacer=e}encode(e){return(e.type===z.EVENT||e.type===z.ACK)&&Rt(e)?this.encodeAsBinary({type:e.type===z.EVENT?z.BINARY_EVENT:z.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let t=""+e.type;return(e.type===z.BINARY_EVENT||e.type===z.BINARY_ACK)&&(t+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(t+=e.nsp+","),e.id!=null&&(t+=e.id),e.data!=null&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=ho(e),n=this.encodeAsString(t.packet),o=t.buffers;return o.unshift(n),o}}function Jr(r){return Object.prototype.toString.call(r)==="[object Object]"}class br extends ce{constructor(e){super(),this.reviver=e}add(e){let t;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===z.BINARY_EVENT;n||t.type===z.BINARY_ACK?(t.type=n?z.EVENT:z.ACK,this.reconstructor=new mo(t),t.attachments===0&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else if(wr(e)||e.base64)if(this.reconstructor)t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(z[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===z.BINARY_EVENT||n.type===z.BINARY_ACK){const a=t+1;for(;e.charAt(++t)!=="-"&&t!=e.length;);const c=e.substring(a,t);if(c!=Number(c)||e.charAt(t)!=="-")throw new Error("Illegal attachments");n.attachments=Number(c)}if(e.charAt(t+1)==="/"){const a=t+1;for(;++t&&!(e.charAt(t)===","||t===e.length););n.nsp=e.substring(a,t)}else n.nsp="/";const o=e.charAt(t+1);if(o!==""&&Number(o)==o){const a=t+1;for(;++t;){const c=e.charAt(t);if(c==null||Number(c)!=c){--t;break}if(t===e.length)break}n.id=Number(e.substring(a,t+1))}if(e.charAt(++t)){const a=this.tryParse(e.substr(t));if(br.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,t){switch(e){case z.CONNECT:return Jr(t);case z.DISCONNECT:return t===void 0;case z.CONNECT_ERROR:return typeof t=="string"||Jr(t);case z.EVENT:case z.BINARY_EVENT:return Array.isArray(t)&&(typeof t[0]=="number"||typeof t[0]=="string"&&go.indexOf(t[0])===-1);case z.ACK:case z.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class mo{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const t=po(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const wo=Object.freeze(Object.defineProperty({__proto__:null,Decoder:br,Encoder:_o,get PacketType(){return z},protocol:yo},Symbol.toStringTag,{value:"Module"}));function Be(r,e,t){return r.on(e,t),function(){r.off(e,t)}}const bo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Fn extends ce{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Be(e,"open",this.onopen.bind(this)),Be(e,"packet",this.onpacket.bind(this)),Be(e,"error",this.onerror.bind(this)),Be(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){var n,o,a;if(bo.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(t.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(t),this;const c={type:z.EVENT,data:t};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof t[t.length-1]=="function"){const y=this.ids++,w=t.pop();this._registerAckCallback(y,w),c.id=y}const l=(o=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||o===void 0?void 0:o.writable,p=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!l||(p?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(e,t){var n;const o=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(o===void 0){this.acks[e]=t;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);t.call(this,new Error("operation has timed out"))},o),c=(...l)=>{this.io.clearTimeoutFn(a),t.apply(this,l)};c.withError=!0,this.acks[e]=c}emitWithAck(e,...t){return new Promise((n,o)=>{const a=(c,l)=>c?o(c):n(l);a.withError=!0,t.push(a),this.emit(e,...t)})}_addToQueue(e){let t;typeof e[e.length-1]=="function"&&(t=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((o,...a)=>n!==this._queue[0]?void 0:(o!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),t&&t(o)):(this._queue.shift(),t&&t(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:z.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case z.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case z.EVENT:case z.BINARY_EVENT:this.onevent(e);break;case z.ACK:case z.BINARY_ACK:this.onack(e);break;case z.DISCONNECT:this.ondisconnect();break;case z.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const t=e.data||[];e.id!=null&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(...o){n||(n=!0,t.packet({type:z.ACK,id:e,data:o}))}}onack(e){const t=this.acks[e.id];typeof t=="function"&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:z.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function ot(r){r=r||{},this.ms=r.min||100,this.max=r.max||1e4,this.factor=r.factor||2,this.jitter=r.jitter>0&&r.jitter<=1?r.jitter:0,this.attempts=0}ot.prototype.duration=function(){var r=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),t=Math.floor(e*this.jitter*r);r=Math.floor(e*10)&1?r+t:r-t}return Math.min(r,this.max)|0};ot.prototype.reset=function(){this.attempts=0};ot.prototype.setMin=function(r){this.ms=r};ot.prototype.setMax=function(r){this.max=r};ot.prototype.setJitter=function(r){this.jitter=r};class dr extends ce{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.opts=t,Nt(this,t),this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor((n=t.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new ot({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(t.timeout==null?2e4:t.timeout),this._readyState="closed",this.uri=e;const o=t.parser||wo;this.encoder=new o.Encoder,this.decoder=new o.Decoder,this._autoConnect=t.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(t=this.backoff)===null||t===void 0||t.setMin(e),this)}randomizationFactor(e){var t;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(t=this.backoff)===null||t===void 0||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(t=this.backoff)===null||t===void 0||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new oo(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const o=Be(t,"open",function(){n.onopen(),e&&e()}),a=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},c=Be(t,"error",a);if(this._timeout!==!1){const l=this._timeout,p=this.setTimeoutFn(()=>{o(),a(new Error("timeout")),t.close()},l);this.opts.autoUnref&&p.unref(),this.subs.push(()=>{this.clearTimeoutFn(p)})}return this.subs.push(o),this.subs.push(c),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Be(e,"ping",this.onping.bind(this)),Be(e,"data",this.ondata.bind(this)),Be(e,"error",this.onerror.bind(this)),Be(e,"close",this.onclose.bind(this)),Be(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}ondecoded(e){kt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Fn(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t)if(this.nsps[n].active)return;this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(o=>{o?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",o)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const lt={};function vt(r,e){typeof r=="object"&&(e=r,r=void 0),e=e||{};const t=ao(r,e.path||"/socket.io"),n=t.source,o=t.id,a=t.path,c=lt[o]&&a in lt[o].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||c;let p;return l?p=new dr(n,e):(lt[o]||(lt[o]=new dr(n,e)),p=lt[o]),t.query&&!e.query&&(e.query=t.queryKey),p.socket(t.path,e)}Object.assign(vt,{Manager:dr,Socket:Fn,io:vt,connect:vt});class Eo{constructor(e,t){ve(this,"socket",null);ve(this,"code");ve(this,"signalHandlers",new Set);ve(this,"peerJoinedHandlers",new Set);this.url=e,this.code=t.trim().toUpperCase()}async prewarm(){console.log("[PWA Signaling] Pre-warming server...");try{const e=new AbortController,t=setTimeout(()=>e.abort(),5e4),n=await fetch(`${this.url}/health`,{signal:e.signal,cache:"no-store"});clearTimeout(t),n.ok&&console.log("[PWA Signaling] Server is warm")}catch(e){console.warn("[PWA Signaling] Pre-warm failed, server may be cold:",e)}}async connect(e=6e4){var t;(t=this.socket)!=null&&t.connected||await new Promise((n,o)=>{const a=setTimeout(()=>{v(),o(new Error("     (,  )"))},e),c=()=>{var C;console.log("[PWA Signaling] Connected, joining room"),(C=this.socket)==null||C.emit("join-room",{code:this.code,role:"creator"})},l=C=>{C.code===this.code&&(console.log("[PWA Signaling] Room joined"),v(),n())},p=()=>{v(),o(new Error("    "))},g=C=>{C.code===this.code&&(v(),o(new Error("   .     .")))},y=()=>{v(),o(new Error("  .    ."))},w=C=>{v(),o(C instanceof Error?C:new Error("     "))},v=()=>{var C,A,x,B,_,T;clearTimeout(a),console.log("[PWA Signaling] Cleanup - removing listeners"),(C=this.socket)==null||C.off("connect",c),(A=this.socket)==null||A.off("connect_error",w),(x=this.socket)==null||x.off("room-joined",l),(B=this.socket)==null||B.off("room-full",p),(_=this.socket)==null||_.off("room-expired",g),(T=this.socket)==null||T.off("room-not-found",y)};this.socket=vt(this.url,{transports:["polling","websocket"],upgrade:!0,forceNew:!0,timeout:5e4}),this.socket.on("connect",c),this.socket.on("connect_error",w),this.socket.on("room-joined",l),this.socket.on("room-full",p),this.socket.on("room-expired",g),this.socket.on("room-not-found",y),this.socket.on("signal",C=>{this.signalHandlers.forEach(A=>A(C))}),this.socket.on("peer-joined",C=>{this.peerJoinedHandlers.forEach(A=>A(C))})})}onSignal(e){return this.signalHandlers.add(e),()=>this.signalHandlers.delete(e)}onPeerJoined(e){return this.peerJoinedHandlers.add(e),()=>this.peerJoinedHandlers.delete(e)}sendSignal(e){var t;(t=this.socket)==null||t.emit("signal",{code:this.code,signal:e})}disconnect(){var e;(e=this.socket)==null||e.disconnect(),this.socket=null,this.signalHandlers.clear()}}class Ro{constructor(e,t){ve(this,"peer",null);ve(this,"signaling");ve(this,"connectionPromise",null);ve(this,"cleanupSignalHandler",null);ve(this,"cleanupPeerJoinedHandler",null);this.code=t,this.signaling=new Eo(e,t)}createPeer(){if(typeof window>"u"||!window.RTCPeerConnection)throw new Error("WebRTC     ");const e=new vs({initiator:!0,trickle:!0,wrtc:void 0,config:{iceServers:Cs}});return console.log("[PWA] Creating SimplePeer as initiator"),this.attachSignalHandler(e),e.on("connect",()=>{console.log("[PWA]  WebRTC connected!")}),e.on("close",()=>{console.log("[PWA]  WebRTC closed")}),e.on("error",t=>{console.error("[PWA]  Peer error:",t)}),this.peer=e,e}attachSignalHandler(e){var t;(t=this.cleanupSignalHandler)==null||t.call(this),this.cleanupSignalHandler=this.signaling.onSignal(n=>e.signal(n.signal)),e.on("signal",n=>{console.log("[PWA] Sending signal:",n.type||"candidate"),this.signaling.sendSignal(n)})}async connect(e,t=6e4){return this.connectionPromise||(this.connectionPromise=(async()=>{e==null||e(" ..."),await this.signaling.prewarm(),e==null||e("  ..."),await this.signaling.connect(),console.log("[PWA] Joined room with code:",this.code),e==null||e(" WebRTC ..."),await new Promise((n,o)=>{let a,c=null;const l=()=>{var g;c==null||c(),(g=this.cleanupPeerJoinedHandler)==null||g.call(this),this.cleanupPeerJoinedHandler=null},p=()=>{var C;c==null||c(),(C=this.peer)==null||C.destroy(),a=this.createPeer();const g=setTimeout(()=>{l(),o(new Error("    "))},t),y=()=>{l(),n()},w=A=>{l(),o(A)},v=()=>{l(),o(new Error("   "))};c=()=>{var A,x,B;clearTimeout(g),(A=a.off)==null||A.call(a,"connect",y),(x=a.off)==null||x.call(a,"error",w),(B=a.off)==null||B.call(a,"close",v)},a.once("connect",y),a.once("error",w),a.once("close",v)};this.cleanupPeerJoinedHandler=this.signaling.onPeerJoined(()=>{var g;(g=this.peer)!=null&&g.connected||p()}),p(),e==null||e(" ...")})})()),this.connectionPromise}getPeerOrThrow(){if(!this.peer)throw new Error("    ");return this.peer}waitForAck(e=1e4){const t=this.getPeerOrThrow();return new Promise((n,o)=>{const a=setTimeout(()=>{g(),o(new Error("    "))},e),c=y=>{(typeof y=="string"?y:new TextDecoder().decode(y))==="ACK"&&(g(),n())},l=y=>{g(),o(y)},p=()=>{g(),o(new Error("   "))},g=()=>{var y,w,v;clearTimeout(a),(y=t.off)==null||y.call(t,"data",c),(w=t.off)==null||w.call(t,"error",l),(v=t.off)==null||v.call(t,"close",p)};t.on("data",c),t.once("error",l),t.once("close",p)})}async sendText(e,t){this.peer||await this.connect();const n=this.getPeerOrThrow(),o={type:"text"};n.send(JSON.stringify(o));const a=Ts(e,St),c=e.length||1;let l=0;for(const p of a)n.send(p),l+=p.length,t==null||t(l/c*100);n.send("EOF"),t==null||t(100),await this.waitForAck()}async sendFile(e,t){this.peer||await this.connect();const n=this.getPeerOrThrow(),o={type:"file",filename:e.name,size:e.size,mimeType:e.type};n.send(JSON.stringify(o));let a=0;for await(const c of Ss(e,St))n.send(c),a+=c.length,t==null||t(a/e.size*100);n.send("EOF"),t==null||t(100),await this.waitForAck()}destroy(){var e,t,n;(e=this.cleanupSignalHandler)==null||e.call(this),(t=this.cleanupPeerJoinedHandler)==null||t.call(this),(n=this.peer)==null||n.destroy(),this.peer=null,this.signaling.disconnect(),this.connectionPromise=null}}function zr(r){let e,t;return{c(){e=W("span"),t=fe(r[10]),U(e,"class","text-xs text-slate-400")},m(n,o){we(n,e,o),I(e,t)},p(n,o){o&1024&&Se(t,n[10])},d(n){n&&ye(e)}}}function Xr(r){let e,t,n,o,a,c=r[6]?"...":" ",l,p,g,y;function w(C){r[18](C)}let v={disabled:r[6],placeholder:"     "};return r[4]!==void 0&&(v.value=r[4]),t=new ui({props:v}),Zt.push(()=>Yn(t,"value",w)),{c(){e=W("div"),dt(t.$$.fragment),o=ee(),a=W("button"),l=fe(c),U(a,"class","bg-primary text-white px-4 py-2 rounded-lg shadow hover:bg-blue-500 disabled:opacity-60"),a.disabled=r[6],U(e,"class","space-y-3")},m(C,A){we(C,e,A),Ze(t,e,null),I(e,o),I(e,a),I(a,l),p=!0,g||(y=Le(a,"click",r[13]),g=!0)},p(C,A){const x={};A&64&&(x.disabled=C[6]),!n&&A&16&&(n=!0,x.value=C[4],Wn(()=>n=!1)),t.$set(x),(!p||A&64)&&c!==(c=C[6]?"...":" ")&&Se(l,c),(!p||A&64)&&(a.disabled=C[6])},i(C){p||(de(t.$$.fragment,C),p=!0)},o(C){xe(t.$$.fragment,C),p=!1},d(C){C&&ye(e),$e(t),g=!1,y()}}}function Qr(r){let e,t,n,o;t=new ri({}),t.$on("select",r[19]);let a=r[5]&&Zr(r);return{c(){e=W("div"),dt(t.$$.fragment),n=ee(),a&&a.c(),U(e,"class","space-y-3")},m(c,l){we(c,e,l),Ze(t,e,null),I(e,n),a&&a.m(e,null),o=!0},p(c,l){c[5]?a?a.p(c,l):(a=Zr(c),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i(c){o||(de(t.$$.fragment,c),o=!0)},o(c){xe(t.$$.fragment,c),o=!1},d(c){c&&ye(e),$e(t),a&&a.d()}}}function Zr(r){let e,t,n,o=r[5].name+"",a,c,l,p=(r[5].size/(1024*1024)).toFixed(2)+"",g,y,w,v,C=r[6]?"...":"",A,x,B;return{c(){e=W("div"),t=W("div"),n=W("p"),a=fe(o),c=ee(),l=W("p"),g=fe(p),y=fe(" "),w=ee(),v=W("button"),A=fe(C),U(n,"class","text-sm font-semibold"),U(l,"class","text-xs text-slate-400"),U(v,"class","bg-primary text-white px-3 py-2 rounded-lg shadow hover:bg-blue-500 disabled:opacity-60"),v.disabled=r[6],U(e,"class","flex items-center justify-between bg-slate-800 rounded-lg px-4 py-3")},m(_,T){we(_,e,T),I(e,t),I(t,n),I(n,a),I(t,c),I(t,l),I(l,g),I(l,y),I(e,w),I(e,v),I(v,A),x||(B=Le(v,"click",r[14]),x=!0)},p(_,T){T&32&&o!==(o=_[5].name+"")&&Se(a,o),T&32&&p!==(p=(_[5].size/(1024*1024)).toFixed(2)+"")&&Se(g,p),T&64&&C!==(C=_[6]?"...":"")&&Se(A,C),T&64&&(v.disabled=_[6])},d(_){_&&ye(e),x=!1,B()}}}function $r(r){let e,t,n=(r[11]||" ...")+"",o,a,c,l;return c=new si({props:{value:r[7]}}),{c(){e=W("div"),t=W("p"),o=fe(n),a=ee(),dt(c.$$.fragment),U(t,"class","text-sm text-slate-300"),U(e,"class","space-y-2")},m(p,g){we(p,e,g),I(e,t),I(t,o),I(e,a),Ze(c,e,null),l=!0},p(p,g){(!l||g&2048)&&n!==(n=(p[11]||" ...")+"")&&Se(o,n);const y={};g&128&&(y.value=p[7]),c.$set(y)},i(p){l||(de(c.$$.fragment,p),l=!0)},o(p){xe(c.$$.fragment,p),l=!1},d(p){p&&ye(e),$e(c)}}}function en(r){let e,t,n,o,a,c,l,p,g,y,w,v,C;return{c(){e=W("div"),t=W("span"),t.textContent="",n=ee(),o=W("div"),a=W("div"),c=W("p"),c.textContent="",l=ee(),p=W("p"),g=fe(r[8]),y=ee(),w=W("button"),w.textContent=" ",U(c,"class","font-semibold"),U(p,"class","text-sm"),U(w,"class","bg-primary text-white px-3 py-2 rounded-lg shadow hover:bg-blue-500 disabled:opacity-60"),U(w,"type","button"),U(o,"class","flex-1 space-y-2"),U(e,"class","rounded-lg bg-slate-800 border border-green-500/30 text-green-300 px-4 py-3 flex items-start gap-2")},m(A,x){we(A,e,x),I(e,t),I(e,n),I(e,o),I(o,a),I(a,c),I(a,l),I(a,p),I(p,g),I(o,y),I(o,w),v||(C=Le(w,"click",r[12]),v=!0)},p(A,x){x&256&&Se(g,A[8])},d(A){A&&ye(e),v=!1,C()}}}function tn(r){let e,t,n,o,a,c,l,p;return{c(){e=W("div"),t=W("span"),t.textContent="",n=ee(),o=W("div"),a=W("p"),a.textContent="",c=ee(),l=W("p"),p=fe(r[9]),U(a,"class","font-semibold"),U(l,"class","text-sm"),U(e,"class","rounded-lg bg-slate-800 border border-red-500/30 text-red-300 px-4 py-3 flex items-start gap-2")},m(g,y){we(g,e,y),I(e,t),I(e,n),I(e,o),I(o,a),I(o,c),I(o,l),I(l,p)},p(g,y){y&512&&Se(p,g[9])},d(g){g&&ye(e)}}}function vo(r){let e,t,n,o,a,c,l,p,g,y,w,v,C,A,x,B,_,T,O,F,L,q,X,H,P,pe,he,be,Ee,Ie;l=new $n({props:{code:r[0]}}),l.$on("copied",r[15]);let oe=r[10]&&zr(r);y=new Xn({props:{status:r[2],tone:r[3]}});let re=r[1]==="text"&&Xr(r),Z=r[1]==="file"&&Qr(r),te=r[6]&&$r(r),se=r[8]&&en(r),le=r[9]&&tn(r);return{c(){e=W("main"),t=W("div"),n=W("header"),n.innerHTML='<p class="text-sm text-blue-300 uppercase tracking-[0.2em]">Pair-In Quick</p> <h1 class="text-4xl font-bold">P2P    </h1> <p class="text-slate-300"> ,    CLI      WebRTC.</p>',o=ee(),a=W("section"),c=W("div"),dt(l.$$.fragment),p=ee(),oe&&oe.c(),g=ee(),dt(y.$$.fragment),w=ee(),v=W("div"),C=W("button"),A=fe("  "),x=ee(),B=W("button"),_=fe("  "),T=ee(),re&&re.c(),O=ee(),Z&&Z.c(),F=ee(),te&&te.c(),L=ee(),se&&se.c(),q=ee(),le&&le.c(),X=ee(),H=W("div"),P=W("button"),P.textContent=" ",pe=ee(),he=W("a"),he.textContent="  ",U(n,"class","space-y-2"),U(c,"class","flex flex-col gap-3 md:flex-row md:items-center md:justify-between"),U(C,"class","w-full bg-primary text-white py-3 rounded-xl font-semibold shadow hover:bg-blue-500 disabled:opacity-60"),C.disabled=r[6],U(B,"class","w-full bg-slate-800 text-white py-3 rounded-xl font-semibold shadow hover:bg-slate-700 border border-slate-700 disabled:opacity-60"),B.disabled=r[6],U(v,"class","grid md:grid-cols-2 gap-4"),U(P,"class","text-sm text-slate-300 underline decoration-dotted underline-offset-4"),U(P,"type","button"),U(he,"class","text-sm text-slate-400"),U(he,"href","https://github.com/kkrugley/pinq"),U(he,"target","_blank"),U(he,"rel","noreferrer"),U(H,"class","flex flex-wrap gap-3"),U(a,"class","bg-slate-900 border border-slate-800 rounded-2xl shadow-lg p-6 space-y-6"),U(t,"class","max-w-3xl mx-auto px-6 py-10 space-y-8"),U(e,"class","min-h-screen bg-gradient-to-b from-slate-900 via-slate-900 to-slate-950 text-slate-50")},m(M,G){we(M,e,G),I(e,t),I(t,n),I(t,o),I(t,a),I(a,c),Ze(l,c,null),I(c,p),oe&&oe.m(c,null),I(a,g),Ze(y,a,null),I(a,w),I(a,v),I(v,C),I(C,A),I(v,x),I(v,B),I(B,_),I(a,T),re&&re.m(a,null),I(a,O),Z&&Z.m(a,null),I(a,F),te&&te.m(a,null),I(a,L),se&&se.m(a,null),I(a,q),le&&le.m(a,null),I(a,X),I(a,H),I(H,P),I(H,pe),I(H,he),be=!0,Ee||(Ie=[Le(C,"click",r[16]),Le(B,"click",r[17]),Le(P,"click",r[12])],Ee=!0)},p(M,[G]){const _e={};G&1&&(_e.code=M[0]),l.$set(_e),M[10]?oe?oe.p(M,G):(oe=zr(M),oe.c(),oe.m(c,null)):oe&&(oe.d(1),oe=null);const ke={};G&4&&(ke.status=M[2]),G&8&&(ke.tone=M[3]),y.$set(ke),(!be||G&64)&&(C.disabled=M[6]),(!be||G&64)&&(B.disabled=M[6]),M[1]==="text"?re?(re.p(M,G),G&2&&de(re,1)):(re=Xr(M),re.c(),de(re,1),re.m(a,O)):re&&(Ft(),xe(re,1,1,()=>{re=null}),It()),M[1]==="file"?Z?(Z.p(M,G),G&2&&de(Z,1)):(Z=Qr(M),Z.c(),de(Z,1),Z.m(a,F)):Z&&(Ft(),xe(Z,1,1,()=>{Z=null}),It()),M[6]?te?(te.p(M,G),G&64&&de(te,1)):(te=$r(M),te.c(),de(te,1),te.m(a,L)):te&&(Ft(),xe(te,1,1,()=>{te=null}),It()),M[8]?se?se.p(M,G):(se=en(M),se.c(),se.m(a,q)):se&&(se.d(1),se=null),M[9]?le?le.p(M,G):(le=tn(M),le.c(),le.m(a,X)):le&&(le.d(1),le=null)},i(M){be||(de(l.$$.fragment,M),de(y.$$.fragment,M),de(re),de(Z),de(te),be=!0)},o(M){xe(l.$$.fragment,M),xe(y.$$.fragment,M),xe(re),xe(Z),xe(te),be=!1},d(M){M&&ye(e),$e(l),oe&&oe.d(),$e(y),re&&re.d(),Z&&Z.d(),te&&te.d(),se&&se.d(),le&&le.d(),Ee=!1,tt(Ie)}}}function Co(r,e,t){let n=Cr(),o=null,a="idle",c="Ready to pair your desktop with a 6-digit code.",l="idle",p="",g=null,y=!1,w=0,v="",C="",A="",x="";function B(){o==null||o.destroy(),o=null,t(0,n=Cr()),t(1,a="idle"),t(2,c="Ready to pair your desktop with a 6-digit code."),t(3,l="idle"),t(4,p=""),t(5,g=null),t(6,y=!1),t(7,w=0),t(8,v=""),t(9,C=""),t(10,A=""),t(11,x="")}Un(()=>o==null?void 0:o.destroy());async function _(){try{o==null||o.destroy(),o=new Ro(li,n),await o.connect(P=>{t(2,c=P),t(3,l=P.toLowerCase().includes("error")?"error":"idle"),P.includes("")&&t(2,c=" ... (      )")}),t(3,l="success"),t(2,c="Connected. Ready to transfer.")}catch(P){throw t(3,l="error"),t(2,c=P instanceof Error?P.message:" "),P}}async function T(){if(!p.trim()){t(9,C="   .");return}t(6,y=!0),t(7,w=0),t(8,v=""),t(9,C=""),t(11,x=" "),t(2,c="   ...");try{await _(),t(2,c=" ..."),await(o==null?void 0:o.sendText(p,P=>{t(7,w=P)})),t(2,c="   ..."),t(3,l="idle"),t(8,v="   ."),t(3,l="success"),t(2,c="!"),t(4,p="")}catch(P){t(3,l="error"),t(2,c="   "),t(9,C=P instanceof Error?P.message:" .")}finally{t(6,y=!1)}}async function O(){if(!g){t(9,C="   .");return}if(g.size>50*1024*1024){t(9,C="   50 .");return}t(6,y=!0),t(7,w=0),t(8,v=""),t(9,C=""),t(11,x=g.name),t(2,c="   ...");try{await _(),t(2,c=" ..."),await(o==null?void 0:o.sendFile(g,P=>{t(7,w=P)})),t(2,c="   ..."),t(3,l="idle"),t(8,v=`${g.name} .`),t(3,l="success"),t(2,c="!"),t(5,g=null)}catch(P){t(3,l="error"),t(2,c="   "),t(9,C=P instanceof Error?P.message:"  .")}finally{t(6,y=!1)}}const F=()=>t(10,A=" !"),L=()=>t(1,a="text"),q=()=>t(1,a="file");function X(P){p=P,t(4,p)}return[n,a,c,l,p,g,y,w,v,C,A,x,B,T,O,F,L,q,X,P=>t(5,g=P.detail)]}class To extends it{constructor(e){super(),nt(this,e,Co,vo,rt,{})}}new To({target:document.getElementById("app")});
